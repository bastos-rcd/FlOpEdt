(function(){"use strict";var e={3684:function(e,t,a){let n="";const i=document.getElementById("json_data");if(i&&i.textContent){const e=JSON.parse(i.textContent);"api"in e&&(n=e.api)}function o(e){if(!document.cookie)return null;const t=document.cookie.split(";").map((e=>e.trim())).filter((t=>t.startsWith(e+"=")));return 0===t.length?null:decodeURIComponent(t[0].split("=")[1])}const s=o("csrftoken");async function r(e,t){const a=t;t=Object.assign({method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin"},t),t.headers=Object.assign({"X-CSRFToken":s,"Content-Type":"application/json"},t.headers);let i="";a&&(i=Object.keys(a).map((e=>e+"="+a[e])).join("&"));const o=`${n}${e}/?${i}`;console.log(`Fetching ${o}...`);const r=await fetch(o,t),l=await r.json()||{};if(!r.ok){const e=l.error||`${r.status}`;throw new Error(e)}return l}async function l(e,t,a){if(!["PUT","POST","DELETE","PATCH"].includes(e))return Promise.reject("Method must be either PUT, POST, PATCH, or DELETE");const i=new Headers;i.set("Content-Type","application/json"),s&&i.set("X-CSRFToken",s);const o={method:e,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:i,redirect:"follow",referrerPolicy:"same-origin"};a.data&&(o.body=JSON.stringify(a.data));let r="/";a.id&&(r=`/${a.id}/`);const l=`${n}${t}${r}`;return console.log(`Updating ${l}...`),await fetch(l,o).then((async e=>{const t=await e.json();if(!e.ok){const a=t||`Error ${e.status}: ${e.statusText}`;return Promise.reject(a)}return t})).catch((e=>Promise.reject(e)))}async function u(e,t,a){const n={id:t,data:a};return await l("PUT",e,n)}async function c(e,t){const a={data:t};return await l("POST",e,a)}async function d(e,t,a){const n={id:t,data:a};return await l("PATCH",e,n)}function m(e,t){const a={id:t};return l("DELETE",e,a)}const v={departments:"fetch/alldepts",rooms:"rooms/room",weekdays:"fetch/weekdays",timesettings:"base/timesettings",roomreservation:"roomreservations/reservation",roomreservationtype:"roomreservations/reservationtype",reservationperiodicity:"roomreservations/reservationperiodicity",reservationperiodicitytype:"roomreservations/reservationperiodicitytype",reservationperiodicitybyweek:"roomreservations/reservationperiodicitybyweek",reservationperiodicityeachmonthsamedate:"roomreservations/reservationperiodicityeachmonthsamedate",reservationperiodicitybymonth:"roomreservations/reservationperiodicitybymonth",reservationperiodicitybymonthxchoice:"roomreservations/reservationperiodicitybymonthxchoice",courses:"courses/courses",scheduledcourses:"fetch/scheduledcourses",coursetypes:"courses/type",users:"user/users",booleanroomattributes:"rooms/booleanattributes",numericroomattributes:"rooms/numericattributes",booleanroomattributevalues:"rooms/booleanattributevalues",numericroomattributevalues:"rooms/numericattributevalues"},p=(e,t,a)=>r(e,t?b(t,a):{});function h(e,t){return`${e}/${t}`}const y={fetch:{booleanRoomAttributes(){return p(v.booleanroomattributes)},booleanRoomAttributeValues(){return p(v.booleanroomattributevalues)},courses(e){return p(v.courses,e,[["department","dept"]])},courseTypes(e){return p(v.coursetypes,e,[["department","dept"]])},departments(){return p(v.departments)},numericRoomAttributes(){return p(v.numericroomattributes)},numericRoomAttributeValues(){return p(v.numericroomattributevalues)},reservationPeriodicities(){return p(v.reservationperiodicity)},reservationPeriodicity(e){return p(v.reservationperiodicity,{id:e})},reservationPeriodicityByMonthXChoices(){return p(v.reservationperiodicitybymonthxchoice)},reservationPeriodicityTypes(){return p(v.reservationperiodicitytype)},room(e,t){return p(h(v.rooms,e.toString()),t)},rooms(e){return p(v.rooms,e,[["department","dept"]])},roomReservations(e){return p(v.roomreservation,e,[["roomId","room"],["periodicityId","periodicity"]])},roomReservationTypes(){return p(v.roomreservationtype)},scheduledCourses(e){return p(v.scheduledcourses,e,[["department","dept"]])},timeSettings(){return p(v.timesettings)},users(){return p(v.users)},weekdays(e){return p(v.weekdays,e)}},put:{roomReservation(e){return u(v.roomreservation,e.id,e)},reservationPeriodicityByMonth(e){return u(v.reservationperiodicitybymonth,e.id,e)},reservationPeriodicityByWeek(e){return u(v.reservationperiodicitybyweek,e.id,e)},reservationPeriodicityEachMonthSameDate(e){return u(v.reservationperiodicityeachmonthsamedate,e.id,e)}},post:{roomReservation(e){return c(v.roomreservation,e)},reservationPeriodicityByMonth(e){return c(v.reservationperiodicitybymonth,e)},reservationPeriodicityByWeek(e){return c(v.reservationperiodicitybyweek,e)},reservationPeriodicityEachMonthSameDate(e){return c(v.reservationperiodicityeachmonthsamedate,e)}},patch:{reservationPeriodicityByMonth(e,t){return d(v.reservationperiodicitybymonth,e,t)},reservationPeriodicityByWeek(e,t){return d(v.reservationperiodicitybyweek,e,t)},reservationPeriodicityEachMonthSameDate(e,t){return d(v.reservationperiodicityeachmonthsamedate,e,t)}},delete:{reservationPeriodicity(e){return m(v.reservationperiodicity,e)},roomReservation(e){return m(v.roomreservation,e)}}};function b(e,t){let a=Object.entries(e).filter((e=>e[1]));return t&&(a=a.map((e=>{const a=t.find((t=>t[0]===e[0])),n=a?a[1]:e[0];return[n,e[1]]}))),Object.fromEntries(a)}var f=a(821);const _=Symbol("currentWeekKey"),w=Symbol("api");function g(e,t){const a=(0,f.f3)(e,t);if(!a)throw new Error(`${e.toString()} was not provided.`);return a}var k=a(1595),D=a(6813),C=(a(7658),a(7327));class S{constructor(e,t){(0,C.Z)(this,"value",void 0),(0,C.Z)(this,"text",void 0),this.value=e,this.text=t}}function x(e){const t=Math.trunc(e),a=Math.round(60*(e-t));return`${t}:${T(a)}`}function T(e){if("string"===typeof e&&(e=parseInt(e,10),isNaN(e)))throw new Error(`Given value (${e}) cannot not be parsed as number`);return`${e<10?`0${e}`:e}`}function E(e,t){if(e instanceof Object&&!(e instanceof Error)){const a=e;Object.keys(a).forEach((e=>{t?.("danger",`${e}: ${a[e]}`)}))}else t?.("danger",`${e}.`)}function M(e,t){const a={};return e.forEach((e=>{const n=t(e);n in a||(a[n]=[]),a[n].push(e)})),a}function H(e){const t=x(e/60);return new S(e,t)}function U(e){return e.map((e=>e.id))}const P={name:"BaseCalendar",components:{}};var F=(0,f.aZ)({...P,setup(e,{expose:t}){const a=(0,f.iH)({}),n=(0,f.iH)("");function i(e,t){a.value[e]=t}function o(e){s(),a.value[e].openContextMenu()&&(n.value=e)}function s(){n.value&&a.value[n.value].closeContextMenu()}function r(){s()}return t({openContextMenu:o,closeCurrentContextMenu:s,storeSlotInterface:i}),(e,t)=>((0,f.wg)(),(0,f.iD)("div",{onClick:r},[(0,f.WI)(e.$slots,"table")]))}});const j=F;var O=j;const I={class:"p-0 flex-nowrap"},R=(0,f._)("th",{class:"p-0 me-3"},null,-1),z={class:"p-0 h-100",style:{"min-width":"50px",width:"50px"}},$={class:"text-wrap"},Z=(0,f._)("hr",{class:"border border-primary border-1 w-100 position-absolute top-0",style:{transform:"translateY(-3px)"}},null,-1),N=["onMousedown","onMouseup"],B={name:"HourCalendar",components:{}};var A=(0,f.aZ)({...B,props:{values:null},emits:["drag"],setup(e,{emit:t}){const a=e,n=15,i=30,o=(0,f.Fl)((()=>{const e={};return Object.keys(a.values.slots).forEach((t=>{t in e||(e[t]=[]),e[t]=a.values.slots[t].filter((e=>w(e.slotData)))})),e})),s=(0,f.Fl)((()=>{const e=Math.trunc(a.values.startTime/60),t=Math.trunc(a.values.endTime/60),n=[];for(let a=e;a<=t;++a){const e={value:60*a,text:x(a)};n.push(e)}return n})),r={startDate:new Date,startTime:{text:"",value:0},endDate:new Date,endTime:{text:"",value:0}};let l=!1;function u(e,t){return Math.round((a.values.startTime+e/v*60)/t)*t}function c(e,t){const i=e.split("/");r.startDate=new Date(`${a.values.year}-${i[1]}-${i[0]}`);const o=u(t.offsetY,n);r.startTime={text:x(o/60),value:o},l=!0}function d(e,n){if(!l)return;l=!1;const o=e.split("/");r.endDate=new Date(`${a.values.year}-${o[1]}-${o[0]}`);const s=r.startTime.value;let c=u(n.offsetY,i);const d=c-s<0;if(!d&&c-s<5&&(c=s+60),c=Math.min(s+Math.round((c-s)/i)*i,a.values.endTime),r.endTime={text:x(c/60),value:c},d){const e=r.endDate,t=r.endTime;r.endDate=r.startDate,r.endTime=r.startTime,r.startTime=t,r.startDate=e}t("drag",r)}function m(e){l&&d(`${r.startDate.getDate()}/${r.startDate.getMonth()+1}`,e)}const v=50,p=(0,f.Fl)((()=>v*(Math.trunc(a.values.endTime/60)-Math.trunc(a.values.startTime/60)))),h=(0,f.Fl)((()=>`${p.value}px`));function y(e){return 100*(e-a.values.startTime)/(a.values.endTime-a.values.startTime)}function b(e){const t=y(e.startTime.value),a=y(e.endTime.value),n=a-t;return`${n}%`}function _(e){const t=y(e);return`${t}%`}function w(e){const t=e.startTime.value>=a.values.startTime;return t||console.log(`Slot ${e.title} cannot be displayed because it does not begin after day start time`),t}function g(e){const t=_(e.startTime.value),a=b(e);return{height:a,top:t,position:"absolute","text-align":"center"}}function k(e){const t=_(e.value);return{top:t,position:"absolute",width:"100%"}}const D=(0,f.iH)();function C(e){D.value&&D.value.openContextMenu(e)}function S(e,t){D.value&&D.value.storeSlotInterface(e,t)}return(e,t)=>((0,f.wg)(),(0,f.j4)(O,{ref_key:"calendar",ref:D},{table:(0,f.w5)((()=>[(0,f._)("table",{class:"w-100",onMouseleave:m},[(0,f._)("tr",I,[R,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.values.days,(e=>((0,f.wg)(),(0,f.iD)("th",{key:e.date,class:(0,f.C_)(["col text-center border-dark border-bottom border-end border-top",{"border-start border-dark":e===a.values.days[0]}])},[(0,f._)("div",null,(0,f.zw)(e.name)+" "+(0,f.zw)(e.date),1)],2)))),128))]),(0,f._)("tr",{class:"flex-nowrap position-relative",style:(0,f.j5)({height:(0,f.SU)(h)})},[(0,f._)("td",z,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)((0,f.SU)(s),(e=>((0,f.wg)(),(0,f.iD)("div",{key:e.value,style:(0,f.j5)(k(e)),class:"translate-middle-y"},[(0,f._)("h6",$,(0,f.zw)(e.text),1),Z],4)))),128))]),((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.values.days,(e=>((0,f.wg)(),(0,f.iD)("td",{key:e.date,class:(0,f.C_)(["col border-dark border-bottom border-end p-0",{"border-start border-dark":e===a.values.days[0]}]),style:(0,f.j5)([{height:(0,f.SU)(h)},{"min-width":"65px"}])},[(0,f._)("div",{class:"position-relative h-100",onMousedown:(0,f.iM)((t=>c(e.date,t)),["left","self"]),onMouseup:(0,f.iM)((t=>d(e.date,t)),["left","self"])},[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)((0,f.SU)(o)[e.date],(e=>((0,f.wg)(),(0,f.j4)((0,f.LL)(e.component.value),{key:e.slotData.id,data:e.slotData,actions:e.actions,style:(0,f.j5)(g(e.slotData)),class:"noselect slot m-0 border border-dark",onContextmenu:[t[0]||(t[0]=(0,f.iM)((()=>{}),["right","prevent"])),t=>C(e.slotData.id)],onInterface:S},null,40,["data","actions","style","onContextmenu"])))),128))],40,N)],6)))),128))],4)],32)])),_:1},512))}});const W=A;var Y=W,L=a(2791);const q={class:"row"},V={name:"WeekPicker",components:{}};var K=(0,f.aZ)({...V,props:{week:null,year:null},emits:["update:week","update:year"],setup(e,{emit:t}){const a=(0,f.iH)([]);function n(e){const t=new Date(Date.UTC(e.getFullYear(),0,1)),a=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));return a.setUTCDate(a.getUTCDate()+4-(a.getUTCDay()||7)),Math.ceil(((a.getTime()-t.getTime())/864e5+1)/7)}(0,f.m0)((()=>{const e=a.value[0];e&&(t("update:week",n(e)),t("update:year",e.getFullYear()))}));const i=(0,f.iH)("fr"),o=(0,f.iH)("Aujourd'hui");return(e,t)=>((0,f.wg)(),(0,f.iD)("div",q,[(0,f.Wm)((0,f.SU)(L.Z),{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),locale:i.value,inline:"","week-numbers":"","week-picker":"","enable-time-picker":!1,"auto-apply":"","show-now-button":"","now-button-label":o.value},null,8,["modelValue","locale","now-button-label"])]))}});const X=K;var Q=X;const G={class:"w-100"},J=(0,f._)("th",{class:"col text-center border-dark border"},"Room",-1),ee={class:"h-100"},te=["onClick"],ae=["onClick"],ne={key:0},ie={name:"RoomCalendar",components:{}};var oe=(0,f.aZ)({...ie,props:{values:null},emits:["newSlot","rowHeaderClick"],setup(e,{emit:t}){const a=e;function n(e,n){const i=e.split("/");t("newSlot",new Date(`${a.values.year}-${i[1]}-${i[0]}`),`${n}`)}const i=(0,f.iH)();function o(e){i.value&&i.value.openContextMenu(e)}function s(e,t){i.value&&i.value.storeSlotInterface(e,t)}return(e,t)=>((0,f.wg)(),(0,f.j4)(O,{ref_key:"calendar",ref:i},{table:(0,f.w5)((()=>[(0,f._)("table",G,[(0,f._)("tr",null,[J,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.values.days,(e=>((0,f.wg)(),(0,f.iD)("th",{key:e.date,class:"col text-center border-dark border"},(0,f.zw)(e.name)+" "+(0,f.zw)(e.date),1)))),128))]),((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.values.rooms,(i=>((0,f.wg)(),(0,f.iD)("tr",{key:i.id,class:"border-dark border align-top h-100"},[(0,f._)("td",ee,[(0,f._)("button",{type:"button",class:"btn btn-outline-dark h-100 w-100 align-middle rounded-0",onClick:t=>e.$emit("rowHeaderClick",i.id)},(0,f.zw)(i.name),9,te)]),((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.values.days,(e=>((0,f.wg)(),(0,f.iD)("td",{key:e.date,class:"border-dark border pb-3",onClick:(0,f.iM)((t=>n(e.date,i.id)),["self","left"])},[e.date in a.values.slots&&i.id in a.values.slots[e.date]?((0,f.wg)(),(0,f.iD)("div",ne,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.values.slots[e.date][i.id],(e=>((0,f.wg)(),(0,f.j4)((0,f.LL)(e.component.value),{key:e.slotData.id,data:e.slotData,actions:e.actions,class:"col noselect slot m-0 border border-dark",onContextmenu:[t[0]||(t[0]=(0,f.iM)((()=>{}),["right","prevent"])),t=>o(e.slotData.id)],onInterface:s},null,40,["data","actions","onContextmenu"])))),128))])):(0,f.kq)("",!0)],8,ae)))),128))])))),128))])])),_:1},512))}});const se=oe;var re=se;const le={class:"card p-0 m-0"},ue={class:"card-body p-1 m-0"},ce={class:"btn-group",role:"group","aria-label":"Slot context menu"},de={name:"CalendarSlotContextMenu",components:{}};var me=(0,f.aZ)({...de,props:{onEdit:{type:Function},onDelete:{type:Function},onDuplicate:{type:Function}},setup(e){const t=e;return(e,a)=>((0,f.wg)(),(0,f.iD)("div",le,[(0,f._)("div",ue,[(0,f._)("div",ce,[(0,f._)("button",{type:"button",class:"btn btn-primary",onClick:a[0]||(a[0]=(...e)=>t.onEdit&&t.onEdit(...e))},"Edit"),(0,f._)("button",{type:"button",class:"btn btn-danger",onClick:a[1]||(a[1]=(...e)=>t.onDelete&&t.onDelete(...e))},"Delete"),(0,f._)("button",{type:"button",class:"btn btn-info",onClick:a[2]||(a[2]=(...e)=>t.onDuplicate&&t.onDuplicate(...e))},"Duplicate")])])]))}});const ve=me;var pe=ve;const he={name:"DayPicker",components:{}};var ye=(0,f.aZ)({...he,props:{startDate:null,clearable:{type:Boolean},shouldReset:{type:Boolean},minDate:null},emits:["update:date","update:week","update:year","onReset"],setup(e,{emit:t}){const a=e,n=(0,f.Fl)({get(){return new Date(a.startDate)},set(e){const a=e;if(!a)return 1;const n=new Date(a.getFullYear(),0,1),i=Math.floor((a.getTime()-n.getTime())/864e5),o=T(a.getDate()),s=T(a.getMonth()+1),r=a.getFullYear();t("update:date",`${r}-${s}-${o}`),t("update:week",Math.ceil(i/7)),t("update:year",r)}});(0,f.YP)((()=>a.shouldReset),(e=>{e&&(n.value=new Date(a.startDate),t("onReset"))}));const i=(0,f.iH)("fr"),o=(0,f.iH)("Aujourd'hui");return(e,t)=>((0,f.wg)(),(0,f.j4)((0,f.SU)(L.Z),{modelValue:(0,f.SU)(n),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,f.dq)(n)?n.value=e:null),locale:i.value,"text-input":"",format:"dd/MM/yyyy","week-numbers":"","enable-time-picker":!1,"auto-apply":"","show-now-button":"","now-button-label":o.value,transitions:!1,"min-date":a.minDate,clearable:a.clearable},{"dp-input":(0,f.w5)((({value:t})=>[(0,f.WI)(e.$slots,"input",{value:t})])),_:3},8,["modelValue","locale","now-button-label","min-date","clearable"]))}});const be=ye;var fe=be,_e=a(8877);const we={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},ge={class:"modal-content"},ke={class:"modal-header"},De={id:"modalTitleLabel",class:"modal-title"},Ce={class:"modal-body"},Se={class:"sticky-top"},xe=(0,f._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"},null,-1),Te={class:"modal-footer"},Ee=["onClick","disabled"],Me=["onClick","disabled"],He={name:"ModalForm",components:{}};var Ue=(0,f.aZ)({...He,props:{isOpen:{type:Boolean},isLocked:{type:Boolean},onCancel:{type:Function},onSave:{type:Function}},emits:["interface"],setup(e,{emit:t}){const a=e,n=(0,f.iH)(),i=(0,f.iH)(!1),o=(0,f.iH)([]);function s(){if(!i.value)return;const e=_e.u_.getOrCreateInstance(n.value);e&&e.show()}function r(){a.onCancel()}function l(){c("info","Sending data, please wait..."),a.onSave()}function u(){if(!i.value)return;const e=_e.u_.getOrCreateInstance(n.value);e&&(d(),e.hide())}function c(e,t){o.value.push({level:e,message:t})}function d(){o.value=[]}return(0,f.YP)((()=>a.isOpen),(e=>{e?s():u()})),(0,f.bv)((()=>{i.value=!0,t("interface",{close:u,addAlert:c,dismissAlerts:d})})),(t,i)=>((0,f.wg)(),(0,f.iD)("div",{ref_key:"modalRef",ref:n,class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"modalTitleLabel","aria-hidden":"true"},[(0,f._)("div",we,[(0,f._)("div",ge,[(0,f._)("div",ke,[(0,f._)("h5",De,[(0,f.WI)(t.$slots,"title")]),a.isLocked?(0,f.kq)("",!0):((0,f.wg)(),(0,f.iD)("button",{key:0,type:"button",class:"btn-close","aria-label":"Close",onClick:i[0]||(i[0]=(0,f.iM)(((...t)=>e.onCancel&&e.onCancel(...t)),["stop"]))}))]),(0,f._)("div",Ce,[(0,f._)("div",Se,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(o.value,(e=>((0,f.wg)(),(0,f.iD)("div",{key:e.message,class:(0,f.C_)([`alert-${e.level}`,"alert alert-dismissible fade show"]),role:"alert"},[(0,f.Uk)((0,f.zw)(e.message)+" ",1),xe],2)))),128))]),(0,f.WI)(t.$slots,"body")]),(0,f._)("div",Te,[(0,f._)("button",{type:"button",class:"btn btn-secondary",onClick:(0,f.iM)(r,["stop"]),disabled:a.isLocked}," Cancel ",8,Ee),(0,f._)("button",{type:"button",class:"btn btn-primary",onClick:(0,f.iM)(l,["stop"]),disabled:a.isLocked}," Save ",8,Me)])])])],512))}});const Pe=Ue;var Fe=Pe;const je={name:"TimePicker",components:{}};var Oe=(0,f.aZ)({...je,props:{hours:null,minutes:null,shouldReset:{type:Boolean}},emits:["updateTime","onReset"],setup(e,{emit:t}){const a=e,n=(0,f.Fl)({get(){return{hours:a.hours,minutes:a.minutes}},set(e){t("updateTime",{hours:e.hours,minutes:e.minutes})}});return(0,f.YP)((()=>a.shouldReset),(e=>{e&&(n.value={hours:a.hours,minutes:a.minutes},t("onReset"))})),(e,t)=>((0,f.wg)(),(0,f.j4)((0,f.SU)(L.Z),{modelValue:(0,f.SU)(n),"onUpdate:modelValue":t[0]||(t[0]=e=>(0,f.dq)(n)?n.value=e:null),"time-picker":"",transitions:!1,clearable:!1},{"dp-input":(0,f.w5)((({value:t})=>[(0,f.WI)(e.$slots,"input",{value:t})])),_:3},8,["modelValue"]))}});const Ie=Oe;var Re=Ie;const ze={class:"mb-2"},$e=["id","value","disabled"],Ze=["for"],Ne={key:0,class:"text-danger"},Be={class:"form-floating"},Ae=["disabled"],We=(0,f._)("label",{for:"input-weeks-interval",class:"form-label"},"Week interval",-1),Ye={name:"PeriodicityByWeekEdit",components:{}};var Le=(0,f.aZ)({...Ye,props:{weekdays:null,model:null,isDisabled:{type:Boolean}},emits:["update:model"],setup(e,{emit:t}){const a=e,n=(0,f.iH)({id:a.model.id,start:a.model.start,end:a.model.end,periodicity_type:a.model.periodicity_type,bw_weeks_interval:a.model.bw_weeks_interval,bw_weekdays:a.model.bw_weekdays}),i=(0,f.Fl)({get(){return n.value.bw_weekdays},set(e){n.value.bw_weekdays=e,r()}}),o=(0,f.Fl)({get(){return n.value.bw_weeks_interval},set(e){n.value.bw_weeks_interval=e,r()}}),s=(0,f.Fl)((()=>0===i.value.length?"border border-danger rounded":""));function r(){t("update:model",n.value)}return(e,t)=>((0,f.wg)(),(0,f.iD)("div",null,[(0,f._)("div",ze,[(0,f._)("div",{class:(0,f.C_)((0,f.SU)(s))},[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.weekdays,(e=>((0,f.wg)(),(0,f.iD)("div",{key:e.num,class:"form-check form-check-inline"},[(0,f.wy)((0,f._)("input",{class:"form-check-input",type:"checkbox",id:`checkbox-weekday-${e.num}`,value:e.ref,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,f.dq)(i)?i.value=e:null),disabled:a.isDisabled},null,8,$e),[[f.e8,(0,f.SU)(i)]]),(0,f._)("label",{class:"form-check-label",for:`checkbox-weekday-${e.num}`},(0,f.zw)(e.name),9,Ze)])))),128))],2),0===(0,f.SU)(i).length?((0,f.wg)(),(0,f.iD)("span",Ne,"* Required")):(0,f.kq)("",!0)]),(0,f._)("div",Be,[(0,f.wy)((0,f._)("input",{type:"number",class:"form-control",id:"input-weeks-interval","onUpdate:modelValue":t[1]||(t[1]=e=>(0,f.dq)(o)?o.value=e:null),min:"1",disabled:a.isDisabled},null,8,Ae),[[f.nr,(0,f.SU)(o)]]),We])]))}});const qe=Le;var Ve=qe;const Ke={class:"input-group mb-3"},Xe=(0,f._)("span",{class:"input-group-text"},"Repeat each",-1),Qe=["disabled"],Ge=(0,f._)("option",{value:void 0,disabled:""},"Select an occurrence number",-1),Je=["value"],et=["disabled"],tt=(0,f._)("option",{value:"",disabled:""},"Select a day",-1),at=["value"],nt=(0,f._)("span",{class:"input-group-text"},"of each month",-1),it={name:"PeriodicityByMonthEdit",components:{}};var ot=(0,f.aZ)({...it,props:{weekdays:null,model:null,isDisabled:{type:Boolean}},emits:["update:model"],setup(e,{emit:t}){const a=e,n=g(w),i=(0,f.iH)([]),o=(0,f.iH)({id:a.model.id,start:a.model.start,end:a.model.end,periodicity_type:a.model.periodicity_type,bm_day_choice:a.model.bm_day_choice,bm_x_choice:a.model.bm_x_choice}),s=(0,f.Fl)({get(){return a.model.bm_day_choice},set(e){o.value.bm_day_choice=e,l()}}),r=(0,f.Fl)({get(){return a.model.bm_x_choice},set(e){o.value.bm_x_choice=e,l()}});function l(){t("update:model",o.value)}const u=(0,f.Fl)((()=>s.value?"":"border border-danger"));return(0,f.bv)((()=>{n.fetch.reservationPeriodicityByMonthXChoices().then((e=>i.value=e))})),(e,t)=>((0,f.wg)(),(0,f.iD)("div",null,[(0,f._)("div",Ke,[Xe,(0,f.wy)((0,f._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>(0,f.dq)(r)?r.value=e:null),class:(0,f.C_)(["form-select",(0,f.SU)(u)]),"aria-label":"Select occurrence number",disabled:a.isDisabled},[Ge,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(i.value,(e=>((0,f.wg)(),(0,f.iD)("option",{key:e[0],value:e[0]},(0,f.zw)(e[1]),9,Je)))),128))],10,Qe),[[f.bM,(0,f.SU)(r)]]),(0,f.wy)((0,f._)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>(0,f.dq)(s)?s.value=e:null),class:"form-select","aria-label":"Select a day",disabled:a.isDisabled},[tt,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.weekdays,(e=>((0,f.wg)(),(0,f.iD)("option",{key:e.num,value:e.ref},(0,f.zw)(e.name),9,at)))),128))],8,et),[[f.bM,(0,f.SU)(s)]]),nt])]))}});const st=ot;var rt=st;const lt=["disabled"],ut=(0,f._)("option",{value:void 0,disabled:""},"Select a periodicity type",-1),ct=["value"],dt={name:"PeriodicitySelect",components:{}};var mt=(0,f.aZ)({...dt,props:{types:null,weekdays:null,modelType:null,modelPeriodicity:null,isDisabled:{type:Boolean}},emits:["update:modelPeriodicity","update:modelType"],setup(e,{emit:t}){const a=e,n=(0,f.Fl)({get(){return a.modelType},set(e){t("update:modelType",e)}}),i=(0,f.iH)(a.modelPeriodicity);(0,f.YP)((()=>a.modelPeriodicity),(e=>{Object.values(i.value).forEach((t=>{t.start=e.BW.start,t.end=e.BW.end}))}));const o=(0,f.Fl)({get(){return i.value.BW},set(e){i.value.BW=e,t("update:modelPeriodicity",i.value)}}),s=(0,f.Fl)({get(){return i.value.BM},set(e){i.value.BM=e,t("update:modelPeriodicity",i.value)}});return(e,t)=>((0,f.wg)(),(0,f.iD)("div",null,[(0,f.wy)((0,f._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>(0,f.dq)(n)?n.value=e:null),class:"form-select mb-2","aria-label":"Select periodicity type",disabled:a.isDisabled},[ut,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.types,(e=>((0,f.wg)(),(0,f.iD)("option",{key:e[0],value:e},(0,f.zw)(e[1]),9,ct)))),128))],8,lt),[[f.bM,(0,f.SU)(n)]]),(0,f.SU)(n)&&"BW"===(0,f.SU)(n)[0]?((0,f.wg)(),(0,f.j4)(Ve,{key:0,weekdays:a.weekdays,"is-disabled":a.isDisabled,model:(0,f.SU)(o),"onUpdate:model":t[1]||(t[1]=e=>(0,f.dq)(o)?o.value=e:null)},null,8,["weekdays","is-disabled","model"])):(0,f.kq)("",!0),(0,f.SU)(n)&&"BM"===(0,f.SU)(n)[0]?((0,f.wg)(),(0,f.j4)(rt,{key:1,weekdays:a.weekdays,"is-disabled":a.isDisabled,model:(0,f.SU)(s),"onUpdate:model":t[2]||(t[2]=e=>(0,f.dq)(s)?s.value=e:null)},null,8,["weekdays","is-disabled","model"])):(0,f.kq)("",!0)]))}});const vt=mt;var pt=vt;const ht={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},yt={class:"modal-content"},bt={class:"modal-header"},ft={id:"modalTitleLabel",class:"modal-title"},_t={class:"modal-body"},wt={class:"modal-footer"},gt=["onClick","disabled"],kt=["onClick","disabled"],Dt={key:0},Ct=(0,f._)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),St=(0,f._)("span",{class:"visually-hidden"},"Loading...",-1),xt=[Ct,St],Tt={key:1},Et={name:"ModalDialog",components:{}};var Mt=(0,f.aZ)({...Et,props:{isOpen:{type:Boolean},isLocked:{type:Boolean},onCancel:{type:Function},onConfirm:{type:Function}},emits:["interface"],setup(e,{emit:t}){const a=e,n=(0,f.iH)(!1),i=(0,f.iH)();function o(){a.onCancel?.()}function s(){a.onConfirm?.()}function r(){if(!n.value)return;const e=_e.u_.getOrCreateInstance(i.value);e&&e.show()}function l(){if(!n.value)return;const e=_e.u_.getOrCreateInstance(i.value);e&&e.hide()}return(0,f.YP)((()=>a.isOpen),(e=>{e?r():l()})),(0,f.bv)((()=>{n.value=!0,t("interface",{close:l})})),(e,t)=>((0,f.wg)(),(0,f.iD)("div",{ref_key:"modalRef",ref:i,class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"modalTitleLabel","aria-hidden":"true"},[(0,f._)("div",ht,[(0,f._)("div",yt,[(0,f._)("div",bt,[(0,f._)("h5",ft,[(0,f.WI)(e.$slots,"title")])]),(0,f._)("div",_t,[(0,f.WI)(e.$slots,"body")]),(0,f._)("div",wt,[(0,f.WI)(e.$slots,"buttons",{},(()=>[(0,f._)("button",{type:"button",class:"btn btn-secondary",onClick:(0,f.iM)(o,["stop"]),disabled:a.isLocked}," Cancel ",8,gt),(0,f._)("button",{type:"button",class:"btn btn-primary",onClick:(0,f.iM)(s,["stop"]),disabled:a.isLocked},[a.isLocked?((0,f.wg)(),(0,f.iD)("span",Dt,xt)):((0,f.wg)(),(0,f.iD)("span",Tt,"Confirm"))],8,kt)]))])])])],512))}});const Ht=Mt;var Ut=Ht;const Pt=(0,f._)("span",null," You are about to remove a repetition. Doing so will cause the next reservations to be lost forever and unlink all previous reservations from this repetition.",-1),Ft=(0,f._)("br",null,null,-1),jt=(0,f._)("span",null,[(0,f._)("b",null,"Are you sure to remove the repetition?")],-1),Ot=(0,f._)("span",null," You are about to save changes to a periodic reservation. Would you like to apply the changes to the future reservations too?",-1),It=(0,f._)("br",null,null,-1),Rt=(0,f._)("span",null,[(0,f._)("b",null,"Applying the changes will overwrite previous values.")],-1),zt=["onClick"],$t=["onClick"],Zt={key:0},Nt=(0,f._)("span",null,"You will not be able to reserve the following dates:",-1),Bt={key:1},At=(0,f._)("span",null,"This reservation is not possible.",-1),Wt=[At],Yt=(0,f._)("br",null,null,-1),Lt={key:2},qt=(0,f._)("span",null,[(0,f.Uk)("The following reservations can be made, "),(0,f._)("b",null,"do you want to create them?")],-1),Vt={class:"text-start mb-2"},Kt={key:0},Xt=["onClick"],Qt=["onClick"],Gt={key:1},Jt=["onClick"],ea={class:"form-floating mb-3"},ta=["id"],aa=["for"],na={class:"form-floating mb-3"},ia=["id"],oa=["for"],sa={class:"form-floating mb-3"},ra=["id"],la=(0,f._)("option",{value:"-1",disabled:""},"Select a room",-1),ua=["value"],ca=["for"],da={class:"mb-3"},ma={class:"form-floating"},va=["id","value"],pa=["for"],ha={class:"row m-0 gx-1 mb-3"},ya={class:"row m-0 gx-1 mb-2"},ba={class:"form-check form-switch"},fa=["id"],_a=["for"],wa={key:0,class:"row m-0 gx-1"},ga={class:"col",style:{"min-width":"100px"}},ka={class:"form-floating"},Da=["id","value"],Ca=["for"],Sa={class:"col",style:{"min-width":"100px"}},xa={class:"form-floating"},Ta=["id","value"],Ea=["for"],Ma={class:"form-floating mb-3"},Ha=["id","value"],Ua=["for"],Pa={class:"form-floating mb-3"},Fa=["id"],ja=(0,f._)("option",{value:-1,disabled:""},"Select a reservation type",-1),Oa=["value"],Ia=["for"],Ra={key:0,class:"mb-3"},za={key:1,class:"mb-3 border rounded p-2"},$a={class:"row mb-2 gx-1"},Za={class:"col"},Na={class:"form-floating"},Ba=["id","value","disabled"],Aa=["for"],Wa={class:"form-check form-switch mb-3"},Ya=["id"],La=["for"],qa={name:"RoomReservationForm",components:{}};var Va=(0,f.aZ)({...qa,props:{reservation:null,isOpen:{type:Boolean},isNew:{type:Boolean},rooms:null,reservationTypes:null,users:null,periodicityTypes:null,weekdays:null,onPeriodicityDelete:{type:Function},dayStart:null,dayEnd:null},emits:["saved","closed","cancelled"],setup(e,{emit:t}){const a=e,n=(0,f.iH)(),i=g(w);class o{constructor(){(0,C.Z)(this,"hours",0),(0,C.Z)(this,"minutes",0)}static fromString(e){const t=e.split(":"),a=new o;return a.hours=parseInt(t[0]),a.minutes=parseInt(t[1]),a}static fromTime(e){const t=new o;return t.hours=Math.trunc(e.value/60),t.minutes=e.value-60*t.hours,t}}(0,C.Z)(o,"toString",(e=>`${e.hours}:${e.minutes}:00`));const s=(0,f.iH)(!1),r=(0,f.iH)(!1),l=(0,f.iH)(!1),u=(0,f.iH)(!1),c=(0,f.Fl)((()=>{const e=a.users[a.reservation.responsible];return e?`${e.first_name} ${e.last_name} (${e.username})`:"Unknown"})),d=(0,f.iH)(),m=(0,f.iH)(!1),v=(0,f.iH)(a.isOpen);(0,f.YP)((()=>a.isOpen),(e=>{v.value=e}));const p=(0,f.iH)(!1),h=(0,f.iH)(!1),y=(0,f.iH)(!1),b=(0,f.iH)(!1),_=(0,f.iH)(a.reservation.title),k=(0,f.iH)(a.reservation.description),D=(0,f.iH)(a.reservation.responsible),S=(0,f.iH)(a.reservation.room),x=(0,f.iH)(a.reservation.reservation_type),T=(0,f.Fl)((()=>null!=a.reservation.periodicity||null!=N.value)),M=(0,f.iH)(a.reservation.email),H=(0,f.iH)(o.fromString(a.reservation.start_time)),U=(0,f.iH)(o.fromString(a.reservation.end_time)),P=(0,f.iH)(a.reservation.date),F=(0,f.iH)(!1),j=(0,f.Fl)((()=>a.reservation.periodicity?a.reservation.periodicity:null)),O=(0,f.iH)(j.value?j.value.periodicity.start:a.reservation.date),I=(0,f.Fl)((()=>{const e=new Date(O.value);return e.setDate(e.getDate()+1),e})),R=(0,f.iH)(j.value?j.value.periodicity.end:I.value.toISOString().split("T")[0]),z=new Date(a.reservation.date).getDay(),$=(0,f.Fl)((()=>{const e=a.weekdays.find((e=>e.num===z-1));return e?.ref})),Z=(0,f.iH)(j.value?a.periodicityTypes.find((e=>e[0]===j.value?.periodicity.periodicity_type)):a.periodicityTypes[0]);(0,f.YP)((()=>a.reservation),(e=>{const t=e.periodicity;t?(Z.value=a.periodicityTypes.find((e=>e[0]===t.periodicity.periodicity_type)),O.value=t.periodicity.start,R.value=t.periodicity.end):(Z.value=void 0,O.value=a.reservation.date,R.value=I.value.toISOString().split("T")[0])})),(0,f.YP)(u,(e=>{e&&(H.value=o.fromTime(a.dayStart),U.value=o.fromTime(a.dayEnd))}));const N=(0,f.Fl)((()=>j.value?j.value.periodicity:null)),B="border border-danger rounded",A=(0,f.Fl)((()=>T.value&&void 0===Z.value?B:"")),W=60*U.value.hours+U.value.minutes-(60*H.value.hours+H.value.minutes),Y=(0,f.iH)({id:Z.value&&"BW"===Z.value[0]&&j.value?j.value.periodicity.id:-1,start:O.value,end:R.value,periodicity_type:"BW",bw_weekdays:$.value?[$.value]:[],bw_weeks_interval:1}),L=(0,f.iH)({id:Z.value&&"BM"===Z.value[0]&&j.value?j.value.periodicity.id:-1,start:O.value,end:R.value,periodicity_type:"BM",bm_x_choice:1,bm_day_choice:$.value??""}),q=(0,f.iH)({id:Z.value&&"EM"===Z.value[0]&&j.value?j.value.periodicity.id:-1,start:O.value,end:R.value,periodicity_type:"EM"});if(a.reservation.periodicity)switch(a.reservation.periodicity.periodicity.periodicity_type){case"BW":{const e=a.reservation.periodicity.periodicity;Y.value.bw_weekdays=e.bw_weekdays,Y.value.bw_weeks_interval=e.bw_weeks_interval}break;case"BM":{const e=a.reservation.periodicity.periodicity;L.value.bm_day_choice=e.bm_day_choice,L.value.bm_x_choice=e.bm_x_choice}break}const V=(0,f.iH)({BW:Y.value,BM:L.value,EM:q.value});function K(){_.value=a.reservation.title,k.value=a.reservation.description,D.value=a.reservation.responsible,S.value=a.reservation.room,x.value=a.reservation.reservation_type,M.value=a.reservation.email,H.value=o.fromString(a.reservation.start_time),U.value=o.fromString(a.reservation.end_time),P.value=a.reservation.date,s.value=!0,r.value=!0,l.value=!0,F.value=!1}function X(){K(),we()}async function Q(){m.value=!0,!a.isNew&&a.reservation.periodicity&&a.reservation.periodicity.periodicity.id>=0?ue():oe()}function G(){le()}function J(){y.value=!0,F.value=!1,a.onPeriodicityDelete(a.reservation).then((e=>{y.value=!1,le()}))}function ee(){y.value=!0,oe(),h.value=!1,y.value=!1}function te(){y.value=!1,m.value=!1,le()}function ae(){m.value=!1,le()}function ne(){if(console.log("create reservations"),!n.value)return m.value=!1,void le();b.value=!1,oe(!0)}function ie(){if(!Z.value||!F.value)return null;let e;switch(Z.value[0]){case"BW":e=V.value.BW;break;case"EM":e=V.value.EM;break;case"BM":e=V.value.BM;break}return e.end=R.value,e}function oe(e=!1){const s=ie(),r=s?{periodicity:s}:a.reservation.periodicity,l={date:P.value,description:k.value,email:M.value,end_time:o.toString(U.value),id:Math.max(0,a.reservation.id),periodicity:r,responsible:D.value,room:S.value,start_time:o.toString(H.value),title:_.value,reservation_type:x.value,create_repetitions:e},u=a.isNew?i.post:i.put;u.roomReservation(l).then((e=>{t("saved",e),_e()}),(e=>{if(e instanceof Object&&Object.keys(e).includes("periodicity")){const t=e.periodicity;console.log(t);let a=[],i={},o={courses:[],reservations:[]},s=!1;Object.keys(t).includes("ok_reservations")&&(a=t.ok_reservations,s=!0),Object.keys(t).includes("nok_reservations")&&(s?i=t.nok_reservations:o=t.nok_reservations),n.value={possible_reservations:a,impossible_reservations:o,impossible_reservations_per_day:i},ce()}else de(e)})).catch((e=>de(e)))}function se(){N.value&&N.value.id>0?re():(F.value=!1,Z.value=void 0)}function re(){v.value=!1,b.value=!1,h.value=!1,p.value=!0}function le(){p.value=!1,b.value=!1,h.value=!1,v.value=!0}function ue(){p.value=!1,b.value=!1,v.value=!1,h.value=!0}function ce(){v.value=!1,p.value=!1,h.value=!1,b.value=!0}function de(e){d.value?.dismissAlerts(),E(e,d.value?.addAlert),m.value=!1}function me(e){d.value=e}function ve(e){P.value=e.replaceAll("/","-"),a.isNew&&(O.value=P.value)}function pe(e){R.value=e.replaceAll("/","-")}function he(e){const t=60*e.hours+e.minutes;let a=60*U.value.hours+U.value.minutes;t>=a&&(a=t+W,ye({hours:Math.trunc(a/60),minutes:a%60})),H.value=e}function ye(e){const t=60*e.hours+e.minutes;let a=60*H.value.hours+H.value.minutes;t<=a&&(a=t-W,he({hours:Math.trunc(a/60),minutes:a%60})),U.value=e}function be(e){return`edit-room-reservation-${e}-${a.reservation.id}`}function _e(){m.value=!1,d.value?.close(),t("closed")}function we(){d.value?.close(),t("cancelled")}function ge(){F.value=!0}return(0,f.YP)(O,(e=>{Object.values(V.value).forEach((t=>{t.start=e}))})),(0,f.YP)(R,(e=>{Object.values(V.value).forEach((t=>{t.end=e}))})),(0,f.m0)((()=>{V.value={BW:Y.value,BM:L.value,EM:q.value}})),(e,t)=>((0,f.wg)(),(0,f.iD)("div",null,[(0,f.Wm)(Ut,{"is-open":p.value,"is-locked":y.value,"on-cancel":G,"on-confirm":J},{title:(0,f.w5)((()=>[(0,f.Uk)("Periodicity deletion")])),body:(0,f.w5)((()=>[Pt,Ft,jt])),_:1},8,["is-open","is-locked"]),(0,f.Wm)(Ut,{"is-open":h.value,"is-locked":y.value},{title:(0,f.w5)((()=>[(0,f.Uk)("Reservation changes")])),body:(0,f.w5)((()=>[Ot,It,Rt])),buttons:(0,f.w5)((()=>[(0,f._)("button",{type:"button",class:"btn btn-secondary",onClick:(0,f.iM)(ee,["stop"])}," Only this one ",8,zt),(0,f._)("button",{type:"button",class:"btn btn-primary",onClick:(0,f.iM)(te,["stop"]),disabled:""}," This one and the next ",8,$t)])),_:1},8,["is-open","is-locked"]),(0,f.Wm)(Ut,{"is-open":b.value,"is-locked":y.value},{title:(0,f.w5)((()=>[(0,f.Uk)("Reservation conflicts")])),body:(0,f.w5)((()=>[n.value&&n.value.impossible_reservations_per_day&&n.value.possible_reservations.length>0?((0,f.wg)(),(0,f.iD)("div",Zt,[Nt,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(Object.entries(n.value.impossible_reservations_per_day),(e=>((0,f.wg)(),(0,f.iD)("ul",{class:"text-start mb-2",key:e[0]},[(0,f._)("li",null,(0,f.zw)(e[0]),1)])))),128))])):(0,f.kq)("",!0),n.value&&n.value.impossible_reservations&&0===n.value.possible_reservations.length?((0,f.wg)(),(0,f.iD)("div",Bt,Wt)):(0,f.kq)("",!0),Yt,n.value&&n.value.possible_reservations.length>0?((0,f.wg)(),(0,f.iD)("div",Lt,[qt,(0,f._)("ul",Vt,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(n.value.possible_reservations,(e=>((0,f.wg)(),(0,f.iD)("li",{key:e.id},(0,f.zw)(new Date(e.date).toLocaleDateString()),1)))),128))])])):(0,f.kq)("",!0)])),buttons:(0,f.w5)((()=>[n.value&&n.value.possible_reservations.length>0?((0,f.wg)(),(0,f.iD)("div",Kt,[(0,f._)("button",{type:"button",class:"btn btn-secondary",onClick:(0,f.iM)(ae,["stop"])}," No ",8,Xt),(0,f._)("button",{type:"button",class:"btn btn-primary",onClick:(0,f.iM)(ne,["stop"])}," Yes ",8,Qt)])):((0,f.wg)(),(0,f.iD)("div",Gt,[(0,f._)("button",{type:"button",class:"btn btn-secondary",onClick:(0,f.iM)(ae,["stop"])}," Cancel ",8,Jt)]))])),_:1},8,["is-open","is-locked"]),(0,f.Wm)(Fe,{"is-open":v.value,"is-locked":m.value,"on-cancel":X,"on-save":Q,onInterface:me,class:"text-start"},{title:(0,f.w5)((()=>[(0,f.Uk)("Room reservation")])),body:(0,f.w5)((()=>[(0,f._)("div",ea,[(0,f.wy)((0,f._)("input",{id:be("title"),type:"text",class:"form-control",placeholder:"Title",maxlength:"30","onUpdate:modelValue":t[0]||(t[0]=e=>_.value=e)},null,8,ta),[[f.nr,_.value]]),(0,f._)("label",{for:be("title"),class:"form-label"},"Title",8,aa)]),(0,f._)("div",na,[(0,f.wy)((0,f._)("textarea",{id:be("description"),type:"text",class:"form-control",placeholder:"Description",rows:"2","onUpdate:modelValue":t[1]||(t[1]=e=>k.value=e)},null,8,ia),[[f.nr,k.value]]),(0,f._)("label",{for:be("description"),class:"form-label"},"Description",8,oa)]),(0,f._)("div",sa,[(0,f.wy)((0,f._)("select",{class:"form-select",id:be("room"),"onUpdate:modelValue":t[2]||(t[2]=e=>S.value=e)},[la,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.rooms,(e=>((0,f.wg)(),(0,f.iD)("option",{key:e.id,value:e.id},(0,f.zw)(e.name),9,ua)))),128))],8,ra),[[f.bM,S.value]]),(0,f._)("label",{for:be("room"),class:"form-label"},"Room",8,ca)]),(0,f._)("div",da,[(0,f.Wm)(fe,{"start-date":P.value,"should-reset":s.value,"on-reset":s.value=!1,"onUpdate:date":ve,"min-date":new Date,clearable:!1},{input:(0,f.w5)((({value:e})=>[(0,f._)("div",ma,[(0,f._)("input",{id:be("date"),type:"text",class:"form-control",placeholder:"Date",value:e},null,8,va),(0,f._)("label",{for:be("date"),class:"form-label"},"Date",8,pa)])])),_:1},8,["start-date","should-reset","on-reset","min-date"])]),(0,f._)("div",ha,[(0,f._)("div",ya,[(0,f._)("div",ba,[(0,f.wy)((0,f._)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>u.value=e),role:"switch",id:be("wholeDay")},null,8,fa),[[f.e8,u.value]]),(0,f._)("label",{class:"form-check-label",for:be("wholeDay")},"Whole day",8,_a)])]),u.value?(0,f.kq)("",!0):((0,f.wg)(),(0,f.iD)("div",wa,[(0,f._)("div",ga,[(0,f.Wm)(Re,{hours:H.value.hours,minutes:H.value.minutes,onUpdateTime:he,"should-reset":r.value,onOnReset:t[4]||(t[4]=e=>r.value=!1)},{input:(0,f.w5)((({value:e})=>[(0,f._)("div",ka,[(0,f._)("input",{id:be("startTime"),type:"text",class:"form-control",placeholder:"Start time",value:e,readonly:""},null,8,Da),(0,f._)("label",{for:be("startTime"),class:"form-label"},"Start time",8,Ca)])])),_:1},8,["hours","minutes","should-reset"])]),(0,f._)("div",Sa,[(0,f.Wm)(Re,{hours:U.value.hours,minutes:U.value.minutes,onUpdateTime:ye,"should-reset":l.value,onOnReset:t[5]||(t[5]=e=>l.value=!1)},{input:(0,f.w5)((({value:e})=>[(0,f._)("div",xa,[(0,f._)("input",{id:be("endTime"),type:"text",class:"form-control",placeholder:"End time",value:e,readonly:""},null,8,Ta),(0,f._)("label",{for:be("endTime"),class:"form-label"},"End time",8,Ea)])])),_:1},8,["hours","minutes","should-reset"])])]))]),(0,f._)("div",Ma,[(0,f._)("input",{id:be("responsible"),type:"text",class:"form-control",placeholder:"Responsible",value:(0,f.SU)(c),disabled:""},null,8,Ha),(0,f._)("label",{for:be("responsible"),class:"form-label"},"Responsible",8,Ua)]),(0,f._)("div",Pa,[(0,f.wy)((0,f._)("select",{class:"form-select",id:be("reservationType"),"onUpdate:modelValue":t[6]||(t[6]=e=>x.value=e)},[ja,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(a.reservationTypes,(e=>((0,f.wg)(),(0,f.iD)("option",{key:e.id,value:e.id},(0,f.zw)(e.name),9,Oa)))),128))],8,Fa),[[f.bM,x.value]]),(0,f._)("label",{for:be("reservationType"),class:"form-label"},"Reservation type",8,Ia)]),(0,f.SU)(T)||F.value?((0,f.wg)(),(0,f.iD)("div",za,[(0,f._)("div",{class:"mb-2 text-center"},[(0,f._)("button",{type:"button",class:"btn btn-danger btn-sm",onClick:se}," Remove repetition ")]),(0,f._)("div",$a,[(0,f._)("div",Za,[(0,f.Wm)(fe,{"start-date":R.value,"should-reset":s.value,"on-reset":s.value=!1,"onUpdate:date":pe,"min-date":(0,f.SU)(I),clearable:!1},{input:(0,f.w5)((({value:e})=>[(0,f._)("div",Na,[(0,f._)("input",{id:be("periodicity-end-date"),type:"text",class:"form-control",placeholder:"Date",value:e,readonly:"",disabled:(0,f.SU)(T)},null,8,Ba),(0,f._)("label",{for:be("periodicity-end-date"),class:"form-label"},"Until",8,Aa)])])),_:1},8,["start-date","should-reset","on-reset","min-date"])])]),(0,f.Wm)(pt,{class:(0,f.C_)((0,f.SU)(A)),types:a.periodicityTypes,weekdays:a.weekdays,"model-type":Z.value,"onUpdate:modelType":t[7]||(t[7]=e=>Z.value=e),modelPeriodicity:V.value,"onUpdate:modelPeriodicity":t[8]||(t[8]=e=>V.value=e),"is-disabled":(0,f.SU)(T)},null,8,["class","types","weekdays","model-type","modelPeriodicity","is-disabled"])])):((0,f.wg)(),(0,f.iD)("div",Ra,[(0,f._)("button",{type:"button",class:"btn btn-info",onClick:ge},"Repeat")])),(0,f._)("div",Wa,[(0,f.wy)((0,f._)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>M.value=e),role:"switch",id:be("email"),disabled:""},null,8,Ya),[[f.e8,M.value]]),(0,f._)("label",{class:"form-check-label",for:be("email")},"Send a confirm email?",8,La)])])),_:1},8,["is-open","is-locked"])]))}});const Ka=Va;var Xa=Ka;const Qa={class:"row m-0 h-100"},Ga={name:"CalendarRoomReservationSlot",components:{}};var Ja=(0,f.aZ)({...Ga,props:{data:null,actions:null},emits:["interface"],setup(e,{emit:t}){const a=e,n=(0,f.iH)(!1),i=(0,f.iH)(0),o=(0,f.iH)(),s=(0,f.iH)(!1);function r(){1!=++i.value?(clearTimeout(o.value),i.value=0,u()):o.value=setTimeout((()=>{i.value=0,l()}),300)}function l(){s.value||console.log(`Click on ${a.data.title}`)}function u(){s.value||y()}function c(e){const t=Object.assign({},a.data);t.reservation=e,a.actions.save?.(t,a.data)}function d(){a.actions.delete?.(a.data)}function m(){console.log("On duplicate")}function v(){b(),a.data.reservation.id<0&&d()}function p(){return n.value=!0,n.value}function h(){n.value=!1}function y(){s.value=!0}function b(){s.value=!1}function _(){t("interface",a.data.id,{openContextMenu:p,closeContextMenu:h})}return(0,f.bv)((()=>{_(),a.data.reservation.id<0&&(s.value=!0)})),(e,t)=>{const i=(0,f.up)("PopperComponent");return(0,f.wg)(),(0,f.j4)(i,{id:a.data.id,class:"frame",show:n.value,style:(0,f.j5)(a.data.displayStyle),arrow:"",onClick:(0,f.iM)(r,["left"])},{content:(0,f.w5)((()=>[(0,f.WI)(e.$slots,"contextmenu",{},(()=>[(0,f.Wm)(pe,{data:a.data,"on-delete":d,"on-edit":u,"on-duplicate":m},null,8,["data"])]))])),default:(0,f.w5)((()=>[(0,f._)("div",null,[(0,f.Wm)(Xa,{reservation:a.data.reservation,"is-open":s.value,"is-new":a.data.reservation.id<0,rooms:a.data.rooms,"reservation-types":a.data.reservationTypes,"periodicity-types":a.data.periodicityTypes,users:a.data.users,weekdays:a.data.weekdays,periodicity:a.data.periodicity,"on-periodicity-delete":a.data.onPeriodicityDelete,"day-start":a.data.dayStart,"day-end":a.data.dayEnd,onClosed:b,onSaved:c,onCancelled:v},null,8,["reservation","is-open","is-new","rooms","reservation-types","periodicity-types","users","weekdays","periodicity","on-periodicity-delete","day-start","day-end"]),(0,f._)("div",Qa,[(0,f.WI)(e.$slots,"text")])])])),_:3},8,["id","show","style","onClick"])}}}),en=a(3744);const tn=(0,en.Z)(Ja,[["__scopeId","data-v-3bdd8a2a"]]);var an=tn;const nn={class:"col-xl-6"},on={class:"col-xl-6"},sn={class:"col-xl-6"},rn={class:"col-xl-6"},ln={name:"HourCalendarRoomReservationSlot",components:{}};var un=(0,f.aZ)({...ln,props:{data:null,actions:null},setup(e){const t=e,a=(0,f.Fl)((()=>{const e=t.data.users[t.data.reservation.responsible];return e?.username})),n=(0,f.Fl)((()=>{const e=t.data.rooms[t.data.reservation.room];return e?.name}));return(e,i)=>((0,f.wg)(),(0,f.j4)(an,{data:t.data,actions:t.actions},{text:(0,f.w5)((()=>[(0,f._)("p",nn,(0,f.zw)(t.data.title),1),(0,f._)("p",on,(0,f.zw)(t.data.reservation.description),1),(0,f._)("p",sn,(0,f.zw)((0,f.SU)(a)),1),(0,f._)("p",rn,(0,f.zw)((0,f.SU)(n)),1)])),_:1},8,["data","actions"]))}});const cn=un;var dn=cn;const mn={class:"col-xl-auto"},vn={class:"col-xl-auto"},pn={class:"col-xl-auto ms-auto"},hn={name:"RoomCalendarRoomReservationSlot",components:{}};var yn=(0,f.aZ)({...hn,props:{data:null,actions:null},setup(e){const t=e,a=(0,f.Fl)((()=>{const e=t.data.users[t.data.reservation.responsible];return e?.username}));return(e,n)=>((0,f.wg)(),(0,f.j4)(an,{data:t.data,actions:t.actions},{text:(0,f.w5)((()=>[(0,f._)("p",mn,(0,f.zw)(t.data.reservation.title),1),(0,f._)("p",vn,(0,f.zw)((0,f.SU)(a)),1),(0,f._)("p",pn,(0,f.zw)(t.data.startTime.text)+"-"+(0,f.zw)(t.data.endTime.text),1)])),_:1},8,["data","actions"]))}});const bn=yn;var fn=bn;const _n={class:"row m-0 course"},wn={name:"CalendarScheduledCourseSlot",components:{}};var gn=(0,f.aZ)({...wn,props:{data:null},emits:["interface"],setup(e,{emit:t}){const a=e,n=(0,f.iH)(!1);function i(){console.log(a.data.title)}function o(){return!1}function s(){}function r(){t("interface",a.data.id,{openContextMenu:o,closeContextMenu:s})}return(0,f.bv)((()=>{r()})),(e,t)=>{const o=(0,f.up)("PopperComponent");return(0,f.wg)(),(0,f.j4)(o,{id:a.data.id,class:"frame",show:n.value,style:(0,f.j5)(a.data.displayStyle),onClick:i},{content:(0,f.w5)((()=>[])),default:(0,f.w5)((()=>[(0,f._)("div",_n,[(0,f.WI)(e.$slots,"text")])])),_:3},8,["id","show","style"])}}});const kn=(0,en.Z)(gn,[["__scopeId","data-v-374ac3eb"]]);var Dn=kn;const Cn={class:"col-xl-6"},Sn={class:"col-xl-6"},xn={class:"col-xl-6"},Tn={class:"col-xl-6"},En={name:"HourCalendarScheduledCourseSlot",components:{}};var Mn=(0,f.aZ)({...En,props:{data:null},setup(e){const t=e,a=(0,f.Fl)((()=>{let e;return t.data.course.room?(e=t.data.rooms[t.data.course.room.id],e.name):"UNKNOWN"}));return(e,n)=>((0,f.wg)(),(0,f.j4)(Dn,{data:t.data},{text:(0,f.w5)((()=>[(0,f._)("p",Cn,(0,f.zw)(t.data.course.course.module.abbrev),1),(0,f._)("p",Sn,(0,f.zw)(t.data.department),1),(0,f._)("p",xn,(0,f.zw)(t.data.course.tutor),1),(0,f._)("p",Tn,(0,f.zw)((0,f.SU)(a)),1)])),_:1},8,["data"]))}});const Hn=Mn;var Un=Hn;const Pn={class:"col-xl-auto"},Fn={class:"col-xl-auto"},jn={class:"col-xl-auto ms-auto"},On={name:"RoomCalendarScheduledCourseSlot",components:{}};var In=(0,f.aZ)({...On,props:{data:null},setup(e){const t=e;return(e,a)=>((0,f.wg)(),(0,f.j4)(Dn,{data:t.data},{text:(0,f.w5)((()=>[(0,f._)("p",Pn,(0,f.zw)(t.data.course.course.module.abbrev),1),(0,f._)("p",Fn,(0,f.zw)(t.data.course.tutor),1),(0,f._)("p",jn,(0,f.zw)(t.data.startTime.text)+"-"+(0,f.zw)(t.data.endTime.text),1)])),_:1},8,["data"]))}});const Rn=In;var zn=Rn;const $n=["for"],Zn=["id"],Nn=(0,f._)("option",{value:void 0},"Select an attribute",-1),Bn=["value","onClick"],An={class:"list-group"},Wn=["value"],Yn={name:"DynamicSelect",components:{}};var Ln=(0,f.aZ)({...Yn,props:{values:null,selectedValues:null,label:null,id:null},emits:["update:selectedValues"],setup(e,{emit:t}){const a=e,n=(0,f.iH)(a.values);function i(e,t){const a=n.value.findIndex((t=>t.value.id===e));a<0||(n.value[a].value=t,c())}(0,f.m0)((()=>{n.value=a.values}));const o=(0,f.iH)(a.selectedValues.map((e=>e.value.id))),s=(0,f.Fl)((()=>n.value.filter((e=>o.value.includes(e.value.id))))),r=(0,f.Fl)((()=>n.value.filter((e=>!o.value.includes(e.value.id)))));function l(e){o.value.push(e),c()}function u(e){o.value=o.value.filter((t=>t!=e)),c()}function c(){t("update:selectedValues",s.value)}return(e,t)=>((0,f.wg)(),(0,f.iD)("div",null,[(0,f._)("label",{for:a.id,class:"form-label"},(0,f.zw)(a.label),9,$n),(0,f._)("select",{id:a.id,class:"form-select w-auto ms-1","aria-label":"Select department"},[Nn,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)((0,f.SU)(r),(e=>((0,f.wg)(),(0,f.iD)("option",{key:e.value.id,value:e.value.id,onClick:t=>l(e.value.id)},(0,f.zw)(e.value.name),9,Bn)))),128))],8,Zn),(0,f._)("ul",An,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(Array.from(Array((0,f.SU)(s).length).keys()),(e=>((0,f.wg)(),(0,f.iD)("li",{key:(0,f.SU)(s)[e].value.id,value:(0,f.SU)(s)[e].value,class:"list-group-item"},[((0,f.wg)(),(0,f.j4)((0,f.LL)((0,f.SU)(s)[e].component),{value:(0,f.SU)(s)[e].value,"onUpdate:value":t=>i((0,f.SU)(s)[e].value.id,t),onRemoved:t=>u((0,f.SU)(s)[e].value.id)},null,40,["value","onUpdate:value","onRemoved"]))],8,Wn)))),128))])]))}});const qn=Ln;var Vn=qn;const Kn={class:"row"},Xn={class:"col"},Qn={name:"DynamicSelectedElement",components:{}};var Gn=(0,f.aZ)({...Qn,props:{value:null},emits:["removed"],setup(e,{emit:t}){const a=e;function n(){t("removed",a.value.id)}return(e,t)=>((0,f.wg)(),(0,f.iD)("div",Kn,[(0,f._)("button",{type:"button",class:"btn-close col-auto","aria-label":"Close",onClick:n}),(0,f._)("div",Xn,(0,f.zw)(a.value.name),1),(0,f.WI)(e.$slots,"input")]))}});const Jn=Gn;var ei=Jn,ti=a(1231);const ai={name:"DoubleThumbSlider",components:{}};var ni=(0,f.aZ)({...ai,props:{initialMin:null,initialMax:null,min:null,max:null},emits:["update:min","update:max"],setup(e,{emit:t}){const a=e,n=(0,f.iH)();function i(e){if(!l.value)return n.value.valueMin=a.min,void(n.value.valueMax=a.max)}function o(){t("update:min",n.value.valueMin),t("update:max",n.value.valueMax)}function s(){u()}function r(){c(),o()}const l=(0,f.iH)(!1);function u(){l.value=!0}function c(){l.value=!1}return(e,t)=>((0,f.wg)(),(0,f.j4)((0,f.SU)(ti.Z),{ref_key:"slider",ref:n,"base-class-name":"multi-range-slider slider",min:a.initialMin,max:a.initialMax,ruler:!1,label:!1,"min-value":a.initialMin,"max-value":a.initialMax,onInput:i,onMouseup:o,onMouseenter:s,onMouseleave:r},null,8,["min","max","min-value","max-value"]))}});const ii=ni;var oi=ii;const si={name:"DynamicSelectedElementNumeric",components:{}};var ri=(0,f.aZ)({...si,props:{value:null},emits:["update:value"],setup(e,{emit:t}){const a=e,n=(0,f.iH)(a.value),i=(0,f.iH)(n.value.min),o=(0,f.iH)(n.value.max);return(0,f.YP)(i,(e=>{n.value.min=e,t("update:value",n.value)})),(0,f.YP)(o,(e=>{n.value.max=e,t("update:value",n.value)})),(e,t)=>((0,f.wg)(),(0,f.j4)(ei,{value:a.value},{input:(0,f.w5)((()=>[(0,f.Wm)(oi,{"initial-min":a.value.initialMin,"initial-max":a.value.initialMax,min:i.value,"onUpdate:min":t[0]||(t[0]=e=>i.value=e),max:o.value,"onUpdate:max":t[1]||(t[1]=e=>o.value=e)},null,8,["initial-min","initial-max","min","max"])])),_:1},8,["value"]))}});const li=ri;var ui=li;const ci={class:"form-check form-switch"},di={name:"DynamicSelectedElementBoolean",components:{}};var mi=(0,f.aZ)({...di,props:{value:null},emits:["update:value"],setup(e,{emit:t}){const a=e,n=(0,f.iH)(a.value),i=(0,f.Fl)({get(){return n.value.value},set(e){n.value.value=e}});return t("update:value",n.value),(e,t)=>((0,f.wg)(),(0,f.j4)(ei,{value:a.value},{input:(0,f.w5)((()=>[(0,f._)("div",null,[(0,f._)("div",ci,[(0,f.wy)((0,f._)("input",{class:"form-check-input",type:"checkbox",role:"switch","onUpdate:modelValue":t[0]||(t[0]=e=>(0,f.dq)(i)?i.value=e:null)},null,512),[[f.e8,(0,f.SU)(i)]])])])])),_:1},8,["value"]))}});const vi=mi;var pi=vi;const hi={class:"row"},yi=["for"],bi={key:0,class:"col-auto pe-0"},fi={class:"col-auto"},_i=["id"],wi={name:"ClearableInput",components:{}};var gi=(0,f.aZ)({...wi,props:{inputId:null,label:null,text:null},emits:["update:text"],setup(e,{emit:t}){const a=e,n=(0,f.Fl)({get(){return a.text},set(e){t("update:text",e)}});function i(){n.value=""}return(e,t)=>((0,f.wg)(),(0,f.iD)("div",hi,[(0,f._)("label",{for:a.inputId,class:"form-label"},(0,f.zw)(a.label),9,yi),a.text.length>0?((0,f.wg)(),(0,f.iD)("div",bi,[(0,f._)("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=e=>i())})])):(0,f.kq)("",!0),(0,f._)("div",fi,[(0,f.wy)((0,f._)("input",{id:a.inputId,type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>(0,f.dq)(n)?n.value=e:null)},null,8,_i),[[f.nr,(0,f.SU)(n)]])])]))}});const ki=gi;var Di=ki;const Ci=(0,f._)("span",null," You are about to remove a reservation related to a periodicity, would you want to remove only this reservation, all the related reservations or this one and all the next? ",-1),Si=["onClick"],xi=["onClick","disabled"],Ti={key:0},Ei=(0,f._)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),Mi=(0,f._)("span",{class:"visually-hidden"},"Loading...",-1),Hi=[Ei,Mi],Ui={key:1},Pi=["onClick","disabled"],Fi={key:0},ji=(0,f._)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),Oi=(0,f._)("span",{class:"visually-hidden"},"Loading...",-1),Ii=[ji,Oi],Ri={key:1},zi=["onClick","disabled"],$i={key:0},Zi=(0,f._)("span",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),Ni=(0,f._)("span",{class:"visually-hidden"},"Loading...",-1),Bi=[Zi,Ni],Ai={key:1},Wi={name:"DeletePeriodicReservationDialog",components:{}};var Yi=(0,f.aZ)({...Wi,props:{isOpen:{type:Boolean},reservation:null,onCancel:{type:Function},onConfirmCurrent:{type:Function},onConfirmAll:{type:Function},onConfirmFuture:{type:Function}},setup(e){const t=e,a=(0,f.iH)(!1),n=(0,f.Fl)((()=>i.value||o.value||s.value)),i=(0,f.iH)(!1),o=(0,f.iH)(!1),s=(0,f.iH)(!1);function r(){t.onCancel()}function l(){i.value=!0,t.onConfirmCurrent(t.reservation)}function u(){o.value=!0,t.onConfirmAll(t.reservation)}function c(){s.value=!0,t.onConfirmFuture(t.reservation)}return(0,f.YP)((()=>t.isOpen),(e=>{i.value=!1,o.value=!1,s.value=!1})),(0,f.bv)((()=>{a.value=!0})),(e,a)=>((0,f.wg)(),(0,f.j4)(Ut,{"is-open":t.isOpen},{title:(0,f.w5)((()=>[(0,f.Uk)("Reservation deletion")])),body:(0,f.w5)((()=>[Ci])),buttons:(0,f.w5)((()=>[(0,f._)("button",{type:"button",class:"btn btn-secondary",onClick:(0,f.iM)(r,["stop"])},"Cancel",8,Si),(0,f._)("button",{type:"button",class:"btn btn-primary",onClick:(0,f.iM)(l,["stop"]),disabled:(0,f.SU)(n)},[i.value?((0,f.wg)(),(0,f.iD)("span",Ti,Hi)):((0,f.wg)(),(0,f.iD)("span",Ui,"Just this one"))],8,xi),(0,f._)("button",{type:"button",class:"btn btn-primary",onClick:(0,f.iM)(u,["stop"]),disabled:(0,f.SU)(n)},[o.value?((0,f.wg)(),(0,f.iD)("span",Fi,Ii)):((0,f.wg)(),(0,f.iD)("span",Ri,"All"))],8,Pi),(0,f._)("button",{type:"button",class:"btn btn-primary",onClick:(0,f.iM)(c,["stop"]),disabled:(0,f.SU)(n)},[s.value?((0,f.wg)(),(0,f.iD)("span",$i,Bi)):((0,f.wg)(),(0,f.iD)("span",Ai,"This one and all the next"))],8,zi)])),_:1},8,["is-open"]))}});const Li=Yi;var qi=Li,Vi=a(6086);let Ki="";const Xi=document.getElementById("json_data");if(Xi&&Xi.textContent){const e=JSON.parse(Xi.textContent);"api"in e&&(Ki=e.api)}function Qi(e){if(!document.cookie)return null;const t=document.cookie.split(";").map((e=>e.trim())).filter((t=>t.startsWith(e+"=")));return 0===t.length?null:decodeURIComponent(t[0].split("=")[1])}const Gi=Qi("csrftoken");function Ji(e){const t=new Headers;return t.set("Content-Type","application/json"),Gi&&t.set("X-CSRFToken",Gi),{method:e,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:t,redirect:"follow",referrerPolicy:"same-origin"}}async function eo(e,t){return await fetch(e,t).then((async e=>{const t=await e.json();if(!e.ok){const a=t||`Error ${e.status}: ${e.statusText}`;return Promise.reject(a)}return t})).catch((e=>Promise.reject(e)))}async function to(e,t){const a=Ji("GET");let n="";t&&(n=Object.keys(t).map((e=>e+"="+t[e])).join("&"));const i=`${Ki}${e}/?${n}`;return console.log(`Fetching ${i}...`),eo(i,a)}async function ao(e,t,a){if(!["PUT","POST","DELETE","PATCH"].includes(e))return Promise.reject("Method must be either PUT, POST, PATCH, or DELETE");const n=Ji(e);a.data&&(n.body=JSON.stringify(a.data));let i="/";a.id&&(i=`/${a.id}/`);const o=`${Ki}${t}${i}`;return console.log(`Updating ${o}...`),eo(o,n)}function no(e,t,a){const n={id:t,data:a};return ao("PUT",e,n)}function io(e,t){const a={data:t};return ao("POST",e,a)}function oo(e,t,a){const n={id:t,data:a};return ao("PATCH",e,n)}const so=[];class ro{constructor(e,t,a,n){(0,C.Z)(this,"convertToApp",void 0),(0,C.Z)(this,"convertToAPI",void 0),(0,C.Z)(this,"onFetch",void 0),(0,C.Z)(this,"url",void 0),this.url=e,this.convertToApp=t,this.convertToAPI=a,this.onFetch=n}convertToPartialAPI(e){return Object.fromEntries(Object.entries(e).map((e=>{const t=e[0],a=e[1];return a?typeof a===typeof so?[t,U(a)]:[t,a]:[]})))}async retrieve(e){return to(this.url,{id:e}).then(this.convertToApp)}async fetch(){return to(this.url,{}).then((e=>e.map(this.convertToApp))).then(this.onFetch)}async update(e,t){return no(this.url,e,this.convertToAPI(t)).then(this.convertToApp)}async create(e){return io(this.url,this.convertToAPI(e)).then(this.convertToApp)}async partialUpdate(e,t){return oo(this.url,e,this.convertToPartialAPI(t)).then(this.convertToApp)}}function lo(e){return{id:e.id??-1,abbrev:e.abbrev??"Unknown"}}function uo(e){return{id:e.id??-1,abbrev:e.abbrev??"Unknown"}}const co=(0,Vi.Q_)("department",(()=>{const e=(0,f.iH)([]),t=(0,f.Fl)((()=>e.value)),a=new ro("fetch/alldepts",lo,uo,(t=>e.value=t));return{departments:t,remote:a}})),mo=(0,Vi.Q_)("room",(()=>{const e=(0,f.iH)([]),t=(0,f.Fl)((()=>e.value)),a=new ro("rooms/room",o,s,(t=>e.value=t)),n=(0,f.Fl)((()=>Object.fromEntries(e.value.map((e=>[e.id,e]))))),i=(0,f.Fl)((()=>{const t=co(),a={};return t.departments.forEach((t=>{a[t.id]=e.value.filter((e=>e.departments.findIndex((e=>e.id===t.id))>=0))})),a}));function o(e){const t=co(),a=mo();return{id:e.id??-1,departments:e.departments?t.departments.filter((t=>e.departments?.includes(t.id))):[],basic_rooms:e.basic_rooms??[],is_basic:e.is_basic??!0,name:e.name??"Unknown",subroom_of:a.rooms.filter((t=>e.id===t.id))}}function s(e){return{id:e.id??-1,departments:e.departments?U(e.departments):[],basic_rooms:e.basic_rooms??[],is_basic:e.is_basic??!0,name:e.name??"Unknown",subroom_of:e.subroom_of?U(e.subroom_of):[]}}return{rooms:t,remote:a,perId:n,perDepartment:i}})),vo=e=>((0,f.dD)("data-v-6bcc11c8"),e=e(),(0,f.Cn)(),e),po={key:0,class:"loader"},ho={class:"container-fluid"},yo={class:"row"},bo={class:"col-6 col-md-5 col-lg-4 col-xl-3"},fo={class:"row"},_o={class:"col"},wo={class:"row mb-3"},go=vo((()=>(0,f._)("label",{for:"select-room",class:"form-label"},"Room:",-1))),ko={key:0,class:"col-auto pe-0"},Do={class:"col-auto"},Co=vo((()=>(0,f._)("option",{value:void 0},"All rooms",-1))),So=["value"],xo={class:"row mb-3"},To=vo((()=>(0,f._)("label",{for:"select-department",class:"form-label"},"Department:",-1))),Eo={key:0,class:"col-auto pe-0"},Mo={class:"col-auto"},Ho=vo((()=>(0,f._)("option",{value:void 0},"All departments",-1))),Uo=["value"],Po={key:0,class:"row"},Fo={class:"mb-3"},jo={class:"mb-3"},Oo={class:"col"},Io={class:"row"},Ro={class:"col-auto"},zo={name:"RoomReservationView",components:{}};var $o=(0,f.aZ)({...zo,setup(e){const t=(0,f.iH)(g(w)),a=(0,f.iH)(g(_));let n="",i=-1,o=0;const s=co(),r=mo(),l={list:(0,f.iH)([])},u={perDepartmentFilterBySelectedDepartments:(0,f.Fl)((()=>ee(r.perDepartment))),listFilterBySelectedDepartments:(0,f.Fl)((()=>{const e=[];return Object.values(u.perDepartmentFilterBySelectedDepartments.value).forEach((t=>{e.push(...t.filter((t=>!e.find((e=>e.id===t.id)))))})),r.rooms.forEach((t=>{0===t.departments.length&&e.findIndex((e=>e.id===t.id))<0&&e.push(t)})),e})),perIdFilterBySelectedDepartments:(0,f.Fl)((()=>Object.fromEntries(u.listFilterBySelectedDepartments.value.filter((e=>e.is_basic)).sort(((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()))).map((e=>[e.id,e]))))),listFilterBySelectedDepartmentsAndFilters:(0,f.Fl)((()=>{const e=[[B.value,k.booleanList.value,(e,t)=>e.value!==t.value],[A.value,k.numericList.value,(e,t)=>Number(t.value)>=e.min&&Number(t.value)<=e.max]];let t=Object.values(u.perIdFilterBySelectedDepartments.value).filter((e=>e.name.toLowerCase().includes(W.value.toLowerCase())));return t=t.filter((t=>{const a=t.id;let n=!0;return e.forEach((e=>{if(!n)return;const t=e[0],i=e[1],o=e[2];t.length>0&&t.forEach((e=>{const t=i.filter((t=>t.attribute===e.id));if(t.length>0){const i=t.find((e=>e.room===a));if(i&&!o(e,i))return void(n=!1)}}))})),n})),t}))},c={list:(0,f.Fl)((()=>Object.values(c.perDepartment.value).flat(1))),perDepartment:(0,f.iH)({}),perDepartmentFilterByDepartmentsAndRooms:(0,f.Fl)((()=>Object.fromEntries(Object.entries(c.perDepartment.value).map((e=>[e[0],e[1].filter((e=>He(e.room.id)&&Me(e.room.id)))]))))),perDay:(0,f.Fl)((()=>M(c.list.value,(e=>{const t=l.list.value.find((t=>t.ref===e.day))?.date;return t||"dateNotFound"})))),perDayPerRoomFilterBySelectedDepartments:(0,f.Fl)((()=>{const e={};return Object.entries(c.perDay.value).forEach((t=>{const a=t[0],n=t[1].filter((e=>{const t=Ue(e);return t&&Z.value.includes(t)}));e[a]=M(n,(e=>`${e.room?.id}`))})),e})),perDayPerRoom:(0,f.Fl)((()=>{const e={};return Object.entries(c.perDay.value).forEach((t=>{const a=t[0],n=t[1];e[a]=M(n,(e=>`${e.room?.id}`))})),e}))},d={perDepartment:(0,f.iH)({}),listFilterBySelectedDepartments:(0,f.Fl)((()=>Object.values(ee(d.perDepartment.value)).flat(1)))},m={list:(0,f.iH)([]),perDay:(0,f.Fl)((()=>M(m.list.value,(e=>{const t=new Date(e.date);return Ee(t.getDate(),t.getMonth()+1)}))))},v={list:(0,f.iH)([]),perId:(0,f.Fl)((()=>Object.fromEntries(v.list.value.map((e=>[e.id,e])))))},p={list:(0,f.iH)([]),perId:(0,f.Fl)((()=>Object.fromEntries(p.list.value.map((e=>[e.periodicity.id,e])))))},h=(0,f.iH)([]),y={list:(0,f.iH)([]),perId:(0,f.Fl)((()=>Object.fromEntries(y.list.value.map((e=>[e.id,e])))))},b={booleanList:(0,f.iH)([]),numericList:(0,f.iH)([])},k={booleanList:(0,f.iH)([]),numericList:(0,f.iH)([])},D=(0,f.iH)(),C=(0,f.iH)({value:0,text:""}),S=(0,f.iH)({value:0,text:""}),x=(0,f.iH)({value:0,text:""}),U=(0,f.iH)({value:0,text:""}),P=60,F="#3399ff",j=(0,f.iH)({week:a.value.week,year:a.value.year}),O=(0,f.iH)(!1),I=(0,f.iH)(),R=(0,f.iH)(!1),z=(0,f.iH)(),$=(0,f.iH)(),Z=(0,f.Fl)((()=>{let e=[];if($.value)e.push($.value);else{if(!s.departments)return[];e=s.departments}return e})),N=(0,f.iH)([]),B=(0,f.Fl)((()=>N.value.filter((e=>e.component===(0,f.Xl)(pi))).map((e=>e.value)))),A=(0,f.Fl)((()=>N.value.filter((e=>e.component===(0,f.Xl)(ui))).map((e=>e.value)))),W=(0,f.iH)(""),L={list:(0,f.Fl)((()=>m.list.value.map(ae))),perDay:(0,f.Fl)((()=>{const e=Object.fromEntries(Object.entries(M(L.list.value,(e=>{const t=new Date(e.slotData.reservation.date);return Ee(t.getDate(),t.getMonth()+1)}))));return e})),perDayFilterBySelectedDepartmentsAndRooms:(0,f.Fl)((()=>{const e=Object.fromEntries(Object.entries(L.perDay.value).map((e=>[e[0],e[1].filter((e=>{const t=e.slotData.reservation.room;return He(t)&&Me(t)}))])));return e})),perDayPerRoomFilterBySelectedDepartments:(0,f.Fl)((()=>{const e=Object.fromEntries(Object.entries(L.perDay.value).map((e=>[e[0],M(e[1].filter((e=>Me(e.slotData.reservation.room))),(e=>`${e.slotData.reservation.room}`))])));return e}))},q={perRooms:(0,f.Fl)((()=>{const e={};return Object.entries(c.perDepartmentFilterByDepartmentsAndRooms.value).map((t=>{const a=t[0];t[1].forEach((t=>{const n=l.list.value.find((e=>e.ref===t.day));if(!n)return;let i=d.perDepartment.value[a].find((e=>e.name===t.course.type));i||(i={name:"unknow",duration:0});const o=n.date,s=ne(t,i,a);oe(e,o,s)}))})),e})),perDayPerRoom:(0,f.Fl)((()=>{const e={};Object.entries(c.perDayPerRoom.value).forEach((t=>{e[t[0]]=Object.fromEntries(Object.entries(t[1]).map((e=>{const t=[];return e[1].forEach((a=>{let n=Ue(a);n||(console.log("has no department"),n={id:-1,abbrev:"UNK"});let i=d.perDepartment.value[n.id].find((e=>e.name===a.course.type));i||(console.log("is not of a good type"),i={name:"Unknown",duration:60});const o=`${n.id}`;let s={departments:[],id:-1,name:"",subroom_of:[],is_basic:!1,basic_rooms:[]};if(a.room)if(s=r.perId[a.room.id],s.is_basic)Me(a.room.id)||console.log("is not in good department"),t.push(ne(a,i,o));else{let n=!1;s.basic_rooms.forEach((e=>{Me(e.id)&&(n=!0)})),n||console.log("No subrooms in good departments"),s.basic_rooms.forEach((n=>{const s=JSON.parse(JSON.stringify(a));s.room={id:n.id,name:n.name},e[0]=s.room.id.toString(),t.push(ne(s,i,o))}))}})),[e[0],t]})))}));const t={};for(const[a,n]of Object.entries(e)){t[a]={};for(const[e,i]of Object.entries(n))for(const n of i){let e=n.slotData.course.room?.id;e||(e=-1),t[a][e]||(t[a][e]=[]),t[a][e].push(n)}}return t}))},V=(0,f.iH)(),K={perDay:(0,f.Fl)((()=>{const e={};if(V.value){const t=V.value,a=ae(t),n=new Date(t.date),i=Ee(n.getDate(),n.getMonth()+1);oe(e,i,a)}return e})),perDayPerRoom:(0,f.Fl)((()=>{const e={};if(V.value){const t=V.value,a=ae(t),n=new Date(t.date),i=Ee(n.getDate(),n.getMonth()+1);e[i]={},oe(e[i],t.room,a)}return e}))},X=(0,f.Fl)((()=>({days:l.list.value,year:`${j.value.year}`}))),G=(0,f.Fl)((()=>{const e={};for(const t of[L.perDayFilterBySelectedDepartmentsAndRooms.value,q.perRooms.value,K.perDay.value])Object.keys(t).forEach((a=>{t[a].forEach((t=>{oe(e,a,t)}))}));return Object.entries(e).forEach((e=>{e[1].sort(((e,t)=>e.slotData.startTime.value-t.slotData.startTime.value))})),Object.assign({slots:e,startTime:C.value.value,endTime:S.value.value},X.value)})),J=(0,f.Fl)((()=>{const e={};for(const t of[L.perDayPerRoomFilterBySelectedDepartments.value,q.perDayPerRoom.value,K.perDayPerRoom.value])Object.entries(t).forEach((t=>{const a=t[0];a in e||(e[a]={}),Object.entries(t[1]).forEach((t=>{t[1].forEach((n=>oe(e[a],t[0],n)))}))}));return Object.values(e).forEach((e=>{Object.values(e).forEach((e=>e.sort(((e,t)=>e.slotData.startTime.value-t.slotData.startTime.value))))})),Object.assign({slots:e,rooms:u.listFilterBySelectedDepartments.value.filter((e=>e.is_basic&&u.listFilterBySelectedDepartmentsAndFilters.value.findIndex((t=>t.id===e.id))>=0)).sort(((e,t)=>e.name.localeCompare(t.name)))},X.value)}));function ee(e){const t=Object.fromEntries(Object.entries(e).filter((([e])=>Z.value.findIndex((t=>`${t.id}`===e))>=0)));return t}function te(e){if(!e)return;let t=e[0].day_start_time,a=e[0].day_finish_time,n=e[0].lunch_break_start_time,i=e[0].lunch_break_finish_time;e.forEach((e=>{t=Math.min(t,e.day_start_time),a=Math.max(a,e.day_finish_time),n=Math.min(n,e.lunch_break_start_time),i=Math.max(i,e.lunch_break_finish_time)})),C.value=H(t),S.value=H(a),x.value=H(n),U.value=H(i)}function ae(e){const t=e.start_time.split(":"),a=60*parseInt(t[0])+parseInt(t[1]),n=H(a),i=e.end_time.split(":"),o=60*parseInt(i[0])+parseInt(i[1]),s=H(o);let r="#ffffff";if(e.reservation_type in v.perId.value){const t=v.perId.value[e.reservation_type];r=t.bg_color}const c={reservation:e,rooms:u.perIdFilterBySelectedDepartments.value,users:y.perId.value,reservationTypes:Object.values(v.list.value),periodicityTypes:h.value,periodicity:e.periodicity,weekdays:l.list.value,day:e.date,startTime:n,endTime:s,dayStart:C.value,dayEnd:S.value,title:e.title,id:`roomreservation-${e.id}`,displayStyle:{background:r},onPeriodicityDelete:()=>{if(!e.periodicity)return Promise.resolve();const t=e.periodicity.periodicity.id,a=he(e);return a?a.then((e=>ye(t))):Promise.reject(`Could not remove the reservations with periodicity id ${t}`)}};return{slotData:c,component:(0,f.XI)(z.value?dn:fn),actions:{delete:me,save:ce}}}function ne(e,t,a){const n=H(e.start_time),i=H(e.start_time+t.duration);let o="";if(s.departments){const e=s.departments.find((e=>`${e.id}`===a));e&&(o=e.abbrev)}const r={course:e,department:o,rooms:u.perIdFilterBySelectedDepartments.value,day:e.day,startTime:n,endTime:i,title:e.course.module.abbrev+"AAA",id:`scheduledcourse-${e.course.id}`,displayStyle:{background:F}};return{slotData:r,component:(0,f.XI)(z.value?Un:zn),actions:{save:void 0,delete:void 0}}}function ie(){const e=[];return e.push(...b.booleanList.value.map((e=>({component:(0,f.Xl)(pi),value:{id:e.id,name:e.name,value:!1}})))),e.push(...b.numericList.value.map((e=>{const t=k.numericList.value.filter((t=>t.attribute===e.id)).map((e=>e.value)),a=Math.min(...t),n=Math.max(...t);return{component:(0,f.Xl)(ui),value:{id:e.id,name:e.name,min:a,max:n,initialMin:a,initialMax:n}}}))),e}function oe(e,t,a){e[t]||(e[t]=[]),e[t].push(a)}function se(e){const a=e.week,n=e.year;return ke(),t.value.fetch.roomReservations({week:a,year:n}).then((e=>{m.list.value=e,V.value=void 0,ge()}))}function le(e,a){const n=e.week,i=e.year;ke(),c.perDepartment.value={};let o=a.length;if(0===o)return void ge();const s={};a.forEach((e=>{t.value.fetch.scheduledCourses({week:n,year:i,department:e.abbrev}).then((t=>{s[e.id]=t,0===--o&&(c.perDepartment.value=s,ge())}))}))}function ue(){return t.value.fetch.reservationPeriodicities().then((e=>{p.list.value=e}))}function ce(e,t){const a=e.reservation,n=t.reservation;if(n.id<0)return m.list.value.push(a),V.value=void 0,void(a.periodicity!=n.periodicity&&(se(j.value),ue()));const i=m.list.value.findIndex((e=>e.id===n.id));i<0?console.error(`Could not find reservation with id: ${n.id}`):(a.periodicity!=n.periodicity&&(se(j.value),ue()),m.list.value[i]=a)}function de(e,t){console.error(`${e}: ${t}`)}function me(e){const t=e.reservation;if(!(t.id<0))return t.periodicity&&t.periodicity.periodicity.id>=0?(I.value=t,void(R.value=!0)):void we(t);V.value=void 0}function ve(e){if(!e.periodicity||e.periodicity.periodicity.id<0)return;const a=e.periodicity.periodicity.id;t.value.fetch.roomReservations({periodicityId:a}).then((e=>{_e(e).then((e=>{t.value.delete.reservationPeriodicity(a)})).finally(be)}))}function pe(e){if(!e.periodicity||e.periodicity.periodicity.id<0)return;const a=e.periodicity.periodicity.id,n=new Date(e.date);he(e)?.then((t=>{fe(e)})).then((e=>{const i=new Date(n);i.setDate(i.getDate()-1);const o=p.perId.value[a].periodicity;if(""===o.periodicity_type)return;let s;switch(o.periodicity_type){case"BM":s=t.value.patch.reservationPeriodicityByMonth;break;case"EM":s=t.value.patch.reservationPeriodicityEachMonthSameDate;break;case"BW":s=t.value.patch.reservationPeriodicityByWeek;break}return s(o.id,{end:i.toISOString().split("T")[0]})}))?.then((e=>{se(j.value),ue()})).finally(be)}function he(e){if(!e.periodicity||e.periodicity.periodicity.id<0)return;const a=e.periodicity.periodicity.id,n=new Date(e.date),i=n.getTime();return t.value.fetch.roomReservations({periodicityId:a}).then((e=>(e=e.filter((e=>new Date(e.date).getTime()>i)),_e(e))))}function ye(e){return t.value.delete.reservationPeriodicity(e).then((e=>{ue()})).then((e=>se(j.value)))}function be(){I.value=void 0,R.value=!1}function fe(e){return t.value.delete.roomReservation(e.id).then((t=>{m.list.value=m.list.value.filter((t=>t.id!=e.id))}),(e=>E(e,de))).catch((e=>E(e,de)))}async function _e(e){await Promise.all(e.map((async e=>await fe(e))))}function we(e){fe(e),be()}function ge(){--o<=0&&(O.value=!1)}function ke(){++o,O.value=!0}function De(e){z.value=r.rooms.find((t=>t.id===e))}function Ce(e){$.value=s.departments.find((t=>t.id===e))}(0,f.m0)((()=>{console.log("Updating Week days"),t.value.fetch.weekdays({week:j.value.week,year:j.value.year}).then((e=>{l.list.value=e}))})),(0,f.m0)((()=>{console.log("Updating Rooms reservations");const e=j.value;se(e)})),(0,f.m0)((()=>{console.log("Updating Scheduled courses");const e=j.value;s.departments&&le(e,s.departments)})),(0,f.m0)((()=>{console.log("Updating time settings"),te(D.value)}));let Se=-1;function xe(e){if(e.startDate.getDate()!=e.endDate.getDate())return void console.error("Reserving a room for more than a day is not accepted.");const t=T(e.startDate.getDate()),a=T(e.startDate.getMonth()+1),n=e.startDate.getFullYear(),o=`${n}-${a}-${t}`;V.value={date:o,description:"",email:!1,end_time:e.endTime.text,id:Se--,periodicity:null,reservation_type:v.list.value[0].id,responsible:i,room:z.value?.id??-1,start_time:e.startTime.text,title:""}}function Te(e,t){const a=new Date,n=`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`;V.value={date:n,description:"",email:!1,end_time:new Date(a.getTime()+6e4*P).toTimeString(),id:Se--,periodicity:null,reservation_type:v.list.value[0].id,responsible:i,room:parseInt(t,10),start_time:a.toTimeString(),title:""}}function Ee(e,t){return`${T(e)}/${T(t)}`}function Me(e){const t=u.listFilterBySelectedDepartments.value.find((t=>t.id===e));return!(!t||!t.basic_rooms.find((t=>t.id===e)))}function He(e){return!(z.value&&!r.perId[e]?.basic_rooms.find((e=>e.id===z.value.id)))}function Ue(e){const t=Object.entries(c.perDepartment.value).find((t=>t[1].find((t=>t.id===e.id))));if(t){const e=t[0];return s.departments.find((t=>`${t.id}`===e))}}return(0,f.bv)((()=>{const e=document.getElementById("json_data");if(e&&e.textContent){const t=JSON.parse(e.textContent);"dept"in t&&(n=t.dept),"user_id"in t&&(i=t.user_id)}s.remote.fetch().then((e=>{if(e){$.value=e.find((e=>e.abbrev===n)),d.perDepartment.value={};const a={};let i=s.departments.length;e.forEach((e=>{t.value.fetch.courseTypes({department:e.abbrev}).then((t=>{a[e.id]=t,0===--i&&(d.perDepartment.value=a)}))}))}})),r.remote.fetch(),t.value.fetch.timeSettings().then((e=>{D.value=e})),t.value.fetch.roomReservationTypes().then((e=>{0===e.length&&(e=["Unknown"]),v.list.value=e})),ue(),t.value.fetch.reservationPeriodicityTypes().then((e=>{h.value=e})),t.value.fetch.users().then((e=>{y.list.value=e})),t.value.fetch.booleanRoomAttributes().then((e=>{b.booleanList.value=e})),t.value.fetch.numericRoomAttributes().then((e=>{b.numericList.value=e})),t.value.fetch.booleanRoomAttributeValues().then((e=>{k.booleanList.value=e})),t.value.fetch.numericRoomAttributeValues().then((e=>{k.numericList.value=e}))})),(e,t)=>((0,f.wg)(),(0,f.iD)("div",null,[O.value?((0,f.wg)(),(0,f.iD)("div",po)):(0,f.kq)("",!0),(0,f.Wm)(qi,{"is-open":R.value,reservation:I.value,"on-confirm-current":we,"on-confirm-all":ve,"on-confirm-future":pe,"on-cancel":be},null,8,["is-open","reservation"]),(0,f._)("div",ho,[(0,f._)("div",yo,[(0,f._)("div",bo,[(0,f.Wm)(Q,{week:j.value.week,"onUpdate:week":t[0]||(t[0]=e=>j.value.week=e),year:j.value.year,"onUpdate:year":t[1]||(t[1]=e=>j.value.year=e)},null,8,["week","year"]),(0,f._)("div",fo,[(0,f._)("div",_o,[(0,f._)("div",wo,[go,z.value?((0,f.wg)(),(0,f.iD)("div",ko,[(0,f._)("button",{type:"button",class:"btn-close",onClick:t[2]||(t[2]=e=>De(-1))})])):(0,f.kq)("",!0),(0,f._)("div",Do,[(0,f.wy)((0,f._)("select",{id:"select-room","onUpdate:modelValue":t[3]||(t[3]=e=>z.value=e),class:"form-select w-auto","aria-label":"Select room"},[Co,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(Object.values(u.perIdFilterBySelectedDepartments.value).filter((e=>e.is_basic)).sort(((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()))),(e=>((0,f.wg)(),(0,f.iD)("option",{key:e.id,value:e},(0,f.zw)(e.name),9,So)))),128))],512),[[f.bM,z.value]])])]),(0,f._)("div",xo,[To,$.value?((0,f.wg)(),(0,f.iD)("div",Eo,[(0,f._)("button",{type:"button",class:"btn-close",onClick:t[4]||(t[4]=e=>Ce(-1))})])):(0,f.kq)("",!0),(0,f._)("div",Mo,[(0,f.wy)((0,f._)("select",{id:"select-department","onUpdate:modelValue":t[5]||(t[5]=e=>$.value=e),class:"form-select w-auto ms-1","aria-label":"Select department"},[Ho,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)((0,f.SU)(s).departments,(e=>((0,f.wg)(),(0,f.iD)("option",{key:e.id,value:e},(0,f.zw)(e.abbrev),9,Uo)))),128))],512),[[f.bM,$.value]])])]),z.value?(0,f.kq)("",!0):((0,f.wg)(),(0,f.iD)("div",Po,[(0,f._)("div",Fo,[(0,f.Wm)(Di,{"input-id":"filter-input-roomName",label:"Filter by room name:",text:W.value,"onUpdate:text":t[6]||(t[6]=e=>W.value=e)},null,8,["text"])]),(0,f._)("div",jo,[(0,f.Wm)(Vn,(0,f.dG)({id:"filter-select-attribute",label:"Filter by attributes:",values:ie()},{"selected-values":N.value,"onUpdate:selectedValues":t[7]||(t[7]=e=>N.value=e)}),null,16,["selected-values"])])]))])])]),(0,f._)("div",Oo,[(0,f._)("div",Io,[(0,f._)("div",Ro,[(0,f._)("div",null,[(0,f._)("span",{style:(0,f.j5)({color:F})}," ",4),(0,f.Uk)("Course")])]),((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(v.list.value,(e=>((0,f.wg)(),(0,f.iD)("div",{key:e.id,class:"col-auto"},[(0,f._)("div",null,[(0,f._)("span",{style:(0,f.j5)({color:e.bg_color})}," ",4),(0,f.Uk)((0,f.zw)(e.name),1)])])))),128))]),z.value?((0,f.wg)(),(0,f.j4)(Y,{key:0,onDrag:xe,values:(0,f.SU)(G)},null,8,["values"])):((0,f.wg)(),(0,f.j4)(re,{key:1,onNewSlot:Te,values:(0,f.SU)(J),onRowHeaderClick:De},null,8,["values"]))])])])]))}});const Zo=(0,en.Z)($o,[["__scopeId","data-v-6bcc11c8"]]);var No=Zo;class Bo{constructor(e,t){(0,C.Z)(this,"_textContent",void 0),(0,C.Z)(this,"_paramCallCount",void 0),this._textContent=e,this._paramCallCount=t}get textContent(){return this._textContent}get paramCallCount(){return this._paramCallCount}}async function Ao(e,t){return new Promise(((a,n)=>to(`/${t}/api/ttapp/docu/${e}.md`,{}).then((e=>{const t=new Map;Object.keys(e.inter).forEach((a=>{t.set(a,e.inter[a])}));const n=new Bo(e.text,t);a(n)})).catch((e=>{n(e)}))))}class Wo{constructor(e,t){(0,C.Z)(this,"_id",void 0),(0,C.Z)(this,"_name",void 0),this.id=e,this.name=t}get id(){return this._id}set id(e){this._id=e}get name(){return this._name}set name(e){this._name=e}toString(){return this.name}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){return new Wo(e.id,e.name)}}const Yo="/fr/api/fetch/idcoursetype";async function Lo(){return to(Yo,{}).then((e=>{const t=[];return e.forEach((e=>{const a=Wo.unserialize(e);t.push(a)})),t}))}class qo{constructor(){(0,C.Z)(this,"map",(0,f.iH)(new Map)),(0,C.Z)(this,"isInitialized",!1),(0,C.Z)(this,"items",(0,f.Fl)((()=>this.map.value)))}insertNew(e){if(this.map.value.has(e.id))throw Error("ID "+e.id+" alredy in the map");this.map.value.set(e.id,e)}initialize(){return new Promise(((e,t)=>{this.isInitialized?e(null):(this.isInitialized=!0,this.gatherData().then((t=>{t.forEach((e=>{this.insertNew(e)})),e(null)})).catch((e=>{console.error("Store initialize() failed : "+e),this.isInitialized=!1,t(null)})))}))}}class Vo extends qo{gatherData(){return Lo()}}const Ko=(0,Vi.Q_)("courseType",(()=>{const e=new Vo,t=e.items;function a(t){e.insertNew(t)}function n(){return e.initialize()}return{items:t,insertNew:a,initialize:n}}));class Xo{constructor(e,t){(0,C.Z)(this,"_id",void 0),(0,C.Z)(this,"_abbrev",void 0),this.id=e,this.abbrev=t}get id(){return this._id}set id(e){this._id=e}get abbrev(){return this._abbrev}set abbrev(e){this._abbrev=e}toString(){return this.abbrev}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){return new Xo(e.id,e.abbrev)}}const Qo="/fr/api/fetch/alldepts";async function Go(){return to(Qo,{}).then((e=>{const t=[];return e.forEach((e=>{const a=Xo.unserialize(e);t.push(a)})),t}))}class Jo extends qo{gatherData(){return Go()}}const es=(0,Vi.Q_)("departmentRework",(()=>{const e=new Jo,t=e.items;function a(t){e.insertNew(t)}function n(){return e.initialize()}return{items:t,insertNew:a,initialize:n}}));class ts{constructor(e,t,a){(0,C.Z)(this,"_id",void 0),(0,C.Z)(this,"_name",void 0),(0,C.Z)(this,"_train_prog",void 0),this.id=e,this.name=t,this.train_prog=a}get id(){return this._id}set id(e){this._id=e}get name(){return this._name}set name(e){this._name=e}get train_prog(){return this._train_prog}set train_prog(e){this._train_prog=e}toString(){return this.train_prog+"-"+this.name}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){return new ts(e.id,e.name,e.train_prog)}}const as="/fr/api/fetch/idgroup";async function ns(){return to(as,{}).then((e=>{const t=[];return e.forEach((e=>{const a=ts.unserialize(e);t.push(a)})),t}))}class is extends qo{gatherData(){return ns()}}const os=(0,Vi.Q_)("group",(()=>{const e=new is,t=e.items;function a(t){e.insertNew(t)}function n(){return e.initialize()}return{items:t,insertNew:a,initialize:n}}));class ss{constructor(e,t,a){(0,C.Z)(this,"_id",void 0),(0,C.Z)(this,"_abbrev",void 0),(0,C.Z)(this,"_name",void 0),this.id=e,this.abbrev=t,this.name=a}get id(){return this._id}set id(e){this._id=e}get abbrev(){return this._abbrev}set abbrev(e){this._abbrev=e}get name(){return this._name}set name(e){this._name=e}toString(){return this.name}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){return new ss(e.id,e.abbrev,e.name)}}const rs="/fr/api/fetch/idmodule";async function ls(){return to(rs,{}).then((e=>{const t=[];return e.forEach((e=>{const a=ss.unserialize(e);t.push(a)})),t}))}class us extends qo{gatherData(){return ls()}}const cs=(0,Vi.Q_)("module",(()=>{const e=new us,t=e.items;function a(t){e.insertNew(t)}function n(){return e.initialize()}return{items:t,insertNew:a,initialize:n}}));class ds{constructor(e,t,a){(0,C.Z)(this,"_id",void 0),(0,C.Z)(this,"_abbrev",void 0),(0,C.Z)(this,"_name",void 0),this.id=e,this.abbrev=t,this.name=a}get id(){return this._id}set id(e){this._id=e}get abbrev(){return this._abbrev}set abbrev(e){this._abbrev=e}get name(){return this._name}set name(e){this._name=e}toString(){return this.abbrev}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){return new ds(e.id,e.abbrev,e.name)}}const ms="/fr/api/fetch/idtrainprog";async function vs(){return to(ms,{}).then((e=>{const t=[];return e.forEach((e=>{const a=ds.unserialize(e);t.push(a)})),t}))}class ps extends qo{gatherData(){return vs()}}const hs=(0,Vi.Q_)("trainProg",(()=>{const e=new ps,t=e.items;function a(t){e.insertNew(t)}function n(){return e.initialize()}return{items:t,insertNew:a,initialize:n}}));class ys{constructor(e,t,a,n,i,o){(0,C.Z)(this,"_id",void 0),(0,C.Z)(this,"_username",void 0),(0,C.Z)(this,"_first_name",void 0),(0,C.Z)(this,"_last_name",void 0),(0,C.Z)(this,"_email",void 0),(0,C.Z)(this,"_departments",void 0),this.id=e,this.username=t}get id(){return this._id}set id(e){this._id=e}get username(){return this._username}set username(e){this._username=e}get first_name(){return this._first_name}set first_name(e){this._first_name=e}get last_name(){return this._last_name}set last_name(e){this._last_name=e}get email(){return this._email}set email(e){this._email=e}get departments(){return this._departments}set departments(e){this._departments=e}toString(){return this.username}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){return new ys(e.id,e.name,e.first_name,e.last_name,e.email,e.departements)}}const bs="/fr/api/fetch/idtutor";async function fs(){return to(bs,{}).then((e=>{const t=[];return e.forEach((e=>{const a=ys.unserialize(e);t.push(a)})),t}))}class _s extends qo{gatherData(){return fs()}}const ws=(0,Vi.Q_)("tutor",(()=>{const e=new _s,t=e.items;function a(t){e.insertNew(t)}function n(){return e.initialize()}return{items:t,insertNew:a,initialize:n}}));class gs{constructor(e,t,a){(0,C.Z)(this,"_id",void 0),(0,C.Z)(this,"_nb",void 0),(0,C.Z)(this,"_year",void 0),this.id=e,this.nb=t,this.year=a}get id(){return this._id}set id(e){this._id=e}get nb(){return this._nb}set nb(e){this._nb=e}get year(){return this._year}set year(e){this._year=e}toString(){return this.nb+"/"+this.year}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){return new gs(e.id,e.nb,e.year)}}const ks="/fr/api/base/weeks";async function Ds(){return to(ks,{}).then((e=>{const t=[];return e.forEach((e=>{const a=gs.unserialize(e);t.push(a)})),t}))}class Cs extends qo{gatherData(){return Ds()}}const Ss=(0,Vi.Q_)("week",(()=>{const e=new Cs,t=e.items;function a(t){e.insertNew(t)}function n(){return e.initialize()}return{items:t,insertNew:a,initialize:n}}));class xs{constructor(e,t,a,n,i,o){(0,C.Z)(this,"_id",void 0),(0,C.Z)(this,"_is_basic",void 0),(0,C.Z)(this,"_name",void 0),(0,C.Z)(this,"_departments",void 0),(0,C.Z)(this,"_subroom_of",void 0),(0,C.Z)(this,"_basic_rooms",void 0),this.id=e,this.is_basic=t,this.name=a,this.departments=n,this.subroom_of=i,this.basic_rooms=o}get id(){return this._id}set id(e){this._id=e}get basic_rooms(){return this._basic_rooms}set basic_rooms(e){this._basic_rooms=e}get subroom_of(){return this._subroom_of}set subroom_of(e){this._subroom_of=e}get departments(){return this._departments}set departments(e){this._departments=e}get is_basic(){return this._is_basic}set is_basic(e){this._is_basic=e}get name(){return this._name}set name(e){this._name=e}toString(){return this.name}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){return new xs(e.id,e.is_basic,e.name,e.departments,e.subroom_of,e.basic_rooms)}}const Ts="/fr/api/rooms/room";async function Es(){return to(Ts,{}).then((e=>{const t=[];return e.forEach((e=>{const a=xs.unserialize(e);t.push(a)})),t}))}class Ms extends qo{gatherData(){return Es()}}const Hs=(0,Vi.Q_)("roomRework",(()=>{const e=new Ms,t=e.items;function a(t){e.insertNew(t)}function n(){return e.initialize()}return{items:t,insertNew:a,initialize:n}})),Us={key:0};var Ps=(0,f.aZ)({__name:"ConstraintParameterDisplayer",props:{idList:null,values:null},setup(e){return(t,a)=>0==e.idList.length?((0,f.wg)(),(0,f.iD)("span",Us,"All")):((0,f.wg)(!0),(0,f.iD)(f.HY,{key:1},(0,f.Ko)(e.idList,(t=>((0,f.wg)(),(0,f.iD)("span",{key:t},(0,f.zw)(e.values.get(t)+" "),1)))),128))}});const Fs=Ps;var js=Fs;const Os={key:0};var Is=(0,f.aZ)({__name:"SimpleConstraintParameterDisplayer",props:{values:null},setup(e){return(t,a)=>0==e.values.length?((0,f.wg)(),(0,f.iD)("span",Os,"All")):((0,f.wg)(!0),(0,f.iD)(f.HY,{key:1},(0,f.Ko)(e.values,(e=>((0,f.wg)(),(0,f.iD)("span",{key:e},(0,f.zw)(e+" "),1)))),128))}});const Rs=Is;var zs=Rs;class $s{constructor(e,t,a,n,i){(0,C.Z)(this,"_name",void 0),(0,C.Z)(this,"_type",void 0),(0,C.Z)(this,"_required",void 0),(0,C.Z)(this,"_multiple",void 0),(0,C.Z)(this,"_id_list",void 0),this.name=e,this.type=t,this.required=a,this.multiple=n,this.id_list=i}get name(){return this._name}set name(e){this._name=e}get type(){return this._type}set type(e){this._type=e}get required(){return this._required}set required(e){this._required=e}get multiple(){return this._multiple}set multiple(e){this._multiple=e}get id_list(){return this._id_list}set id_list(e){this._id_list=e}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){const t=[];return e.id_list.forEach((e=>{t.push(+e)})),new $s(e.name,e.type,e.required,e.multiple,t)}static objectTypes(){return $s.CONSTR_PARAMETER_TYPE}static primitiveTypes(){return $s.CONSTR_PARAMETER_PRIMITIVE_TYPE}}(0,C.Z)($s,"CONSTR_PARAMETER_TYPE",["base.Week","base.TrainingProgramme","base.CourseType","base.Module","people.Tutor","base.StructuralGroup","base.Room","base.Department"]),(0,C.Z)($s,"CONSTR_PARAMETER_PRIMITIVE_TYPE",["PositiveSmallIntegerField","CharField","BooleanField"]);const Zs={key:1};var Ns=(0,f.aZ)({__name:"MarkdownDisplayer",props:{doc:null,constraint:null},async setup(e){let t,a;const n=e,i="table table-bordered",o={type:"output",filter:function(e){return e.replace(/<table>/g,`<table class="${i}">`)}},s=Ko(),r=es(),l=os(),u=cs(),c=hs(),d=ws(),m=Ss(),v=Hs(),p=new Map([["base.CourseType",s.items],["base.Department",r.items],["base.StructuralGroup",l.items],["base.Module",u.items],["base.TrainingProgramme",c.items],["people.Tutor",d.items],["base.Week",m.items],["base.Room",v.items]]),h=Array.from(n.doc.paramCallCount.keys()),y=(0,f.iH)(!1);async function b(){const e=[s.initialize(),r.initialize(),l.initialize(),u.initialize(),c.initialize(),d.initialize(),m.initialize(),v.initialize()];await Promise.all(e)}function _(e){const t=n.doc.paramCallCount.get(e);return t?Array.from({length:t},((e,t)=>t+1)):(console.warn(`${e} not found in the documentation map of interporlation`),[])}function w(e){const t=n.constraint.parameters.has(e);return t||console.warn(`${e} not found in the constraint's parameters`),t}function g(e){return null!=n.constraint.parameters.get(e)}function k(e){return window.eval(`gettext("${e}")`)}return[t,a]=(0,f.mv)((()=>b())),await t,a(),(0,f.bv)((()=>{y.value=!0})),(t,a)=>((0,f.wg)(),(0,f.iD)(f.HY,null,[(0,f._)("div",null,[(0,f.Wm)((0,f.SU)(D.Kf),{markdown:e.doc.textContent,options:{tables:!0},extensions:[o]},null,8,["markdown","extensions"])]),y.value?((0,f.wg)(),(0,f.iD)(f.HY,{key:0},[e.constraint?((0,f.wg)(!0),(0,f.iD)(f.HY,{key:0},(0,f.Ko)((0,f.SU)(h),(t=>((0,f.wg)(),(0,f.iD)(f.HY,{key:t},[w(t)?((0,f.wg)(!0),(0,f.iD)(f.HY,{key:0},(0,f.Ko)(_(t),(a=>((0,f.wg)(),(0,f.j4)(f.lR,{key:a,to:"#"+t+"Displayer"+a},[g(t)?((0,f.wg)(),(0,f.iD)(f.HY,{key:0},[(0,f.SU)($s).primitiveTypes().includes(e.constraint.parameters.get(t)?.type)?((0,f.wg)(),(0,f.j4)(zs,{key:0,values:e.constraint.parameters.get(t)?.id_list},null,8,["values"])):(0,f.kq)("",!0),(0,f.SU)($s).objectTypes().includes(e.constraint.parameters.get(t)?.type)?((0,f.wg)(),(0,f.j4)(js,{key:1,idList:e.constraint.parameters.get(t)?.id_list,values:(0,f.SU)(p).get(e.constraint.parameters.get(t)?.type)},null,8,["idList","values"])):(0,f.kq)("",!0)],64)):((0,f.wg)(),(0,f.iD)("i",Zs,(0,f.zw)(k(t)),1))],8,["to"])))),128)):(0,f.kq)("",!0)],64)))),128)):(0,f.kq)("",!0)],64)):(0,f.kq)("",!0)],64))}});const Bs=Ns;var As=Bs;const Ws=e=>((0,f.dD)("data-v-641f715e"),e=e(),(0,f.Cn)(),e),Ys={class:"container"},Ls={key:0},qs={key:0},Vs={key:1,class:"docNotFoundContainer"},Ks=Ws((()=>(0,f._)("b",{class:"text"},"Cannot found documentation",-1))),Xs=[Ks];var Qs=(0,f.aZ)({__name:"DocumentationLoader",props:{constraint:null},setup(e){const t=e,a=(0,f.f3)("lang"),n=(0,f.iH)(null),i=(0,f.iH)(!1),o=(0,f.iH)(!1);async function s(){o.value=!0,i.value=!1,await Ao(t.constraint.className,a).then((e=>{i.value=!0,n.value=e})).catch((e=>console.log(e))).finally((()=>o.value=!1))}return(0,f.YP)((()=>t.constraint),((e,t)=>{e!=t&&s()})),s(),(t,a)=>((0,f.wg)(),(0,f.iD)("div",Ys,[o.value?((0,f.wg)(),(0,f.iD)("p",Ls,"Loading the documentation")):((0,f.wg)(),(0,f.iD)(f.HY,{key:1},[i.value?((0,f.wg)(),(0,f.iD)("div",qs,[n.value?((0,f.wg)(),(0,f.j4)(f.n4,{key:0},{fallback:(0,f.w5)((()=>[(0,f.Uk)(" Loading data")])),default:(0,f.w5)((()=>[(0,f.Wm)(As,{doc:n.value,constraint:e.constraint},null,8,["doc","constraint"])])),_:1})):(0,f.kq)("",!0)])):((0,f.wg)(),(0,f.iD)("div",Vs,Xs))],64))]))}});const Gs=(0,en.Z)(Qs,[["__scopeId","data-v-641f715e"]]);var Js=Gs;const er={class:"documentationContainer"},tr={class:"buttonContainer"},ar={key:0,class:"scrollbar scrollbar-primary"};var nr=(0,f.aZ)({__name:"DocDisplayerControler",props:{showDoc:{type:Boolean},constraint:null,hideLabel:null,showLabel:null},emits:["updateShowDoc"],setup(e,{emit:t}){const a=e,n=()=>a.showDoc?" minusButton ":" plusButton ";function i(){t("updateShowDoc",a.showDoc)}return(t,a)=>((0,f.wg)(),(0,f.iD)("div",er,[(0,f._)("div",tr,[(0,f._)("button",{id:"doc-show-btn",class:(0,f.C_)(n()),onClick:i},(0,f.zw)(e.showDoc?e.hideLabel:e.showLabel),3)]),e.showDoc?((0,f.wg)(),(0,f.iD)("div",ar,[e.constraint?((0,f.wg)(),(0,f.j4)(Js,{key:0,constraint:e.constraint},null,8,["constraint"])):(0,f.kq)("",!0)])):(0,f.kq)("",!0)]))}});const ir=nr;var or=ir;const sr=new RegExp("^(?<className>.+)(?<inClassId>\\d)+$");class rr{constructor(e,t,a,n,i,o,s,r){(0,C.Z)(this,"_inClassId",void 0),(0,C.Z)(this,"_title",void 0),(0,C.Z)(this,"_className",void 0),(0,C.Z)(this,"_weight",void 0),(0,C.Z)(this,"_is_active",void 0),(0,C.Z)(this,"_comment",void 0),(0,C.Z)(this,"_modified_at",void 0),(0,C.Z)(this,"_parameters",void 0),this.inClassId=e,this.title=t,this.className=a,this.weight=n,this.is_active=i,this.comment=o,this.modified_at=s,this.parameters=r}get id(){return this.className+this._inClassId}set id(e){const t=e.match(sr);if(!(t&&t.groups?.inClassId&&t.groups?.className))throw Error("Invalid argument");this._inClassId=+t.groups.inClassId,this._className=t.groups.className}get inClassId(){return this._inClassId}set inClassId(e){this._inClassId=e}get title(){return this._title}set title(e){this._title=e}get className(){return this._className}set className(e){this._className=e}get weight(){return this._weight}set weight(e){this._weight=e}get is_active(){return this._is_active}set is_active(e){this._is_active=e}get comment(){return this._comment}set comment(e){this._comment=e}get modified_at(){return this._modified_at}set modified_at(e){this._modified_at=e}get parameters(){return this._parameters}set parameters(e){this._parameters=e}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){const t=new Map;return e.parameters.forEach((e=>{const a=$s.unserialize(e);t.set(a.name,a)})),new rr(e.id,e.title,e.name,e.weight,e.is_active,e.comment,e.modified_at,t)}}class lr{constructor(e,t,a,n){(0,C.Z)(this,"_name",void 0),(0,C.Z)(this,"_type",void 0),(0,C.Z)(this,"_required",void 0),(0,C.Z)(this,"_multiple",void 0),this.name=e,this.type=t,this.required=a,this.multiple=n}get name(){return this._name}set name(e){this._name=e}get type(){return this._type}set type(e){this._type=e}get required(){return this._required}set required(e){this._required=e}get multiple(){return this._multiple}set multiple(e){this._multiple=e}toString(){return"["+this.name+"; "+this.type+"; "+this.required+"; "+this.multiple+"]"}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){return new lr(e.name,e.type,e.required,e.multiple)}}class ur{constructor(e,t,a){(0,C.Z)(this,"_className",void 0),(0,C.Z)(this,"_local_name",void 0),(0,C.Z)(this,"_parameters",void 0),this.className=e,this.local_name=t,this.parameters=a}get className(){return this._className}set className(e){this._className=e}get local_name(){return this._local_name}set local_name(e){this._local_name=e}get parameters(){return this._parameters}set parameters(e){this._parameters=e}toString(){return"["+this.className+"; "+this.local_name+"; "+this.parameters+"]"}static serialize(e){throw Error("Method not yet implemented")}static unserialize(e){const t=new Map;return e.parameters.forEach((e=>{const a=lr.unserialize(e);t.set(a.name,a)})),new ur(e.name,e.local_name,t)}}async function cr(){return await to("/fr/api/ttapp/constraint_types",{}).then((function(e){const t=new Map;return e.forEach((e=>{const a=ur.unserialize(e);t.set(a.className,a)})),t}))}const dr="/fr/api/ttapp/constraint";async function mr(e){return to(dr,{dept:e}).then((e=>{const t=[];return e.forEach((e=>{const a=rr.unserialize(e);t.push(a)})),t}))}class vr extends qo{constructor(){super(),(0,C.Z)(this,"dep",void 0);const e=window.eval(vr.G_CURRENT_DEPARTMENT);e||console.error("Current department not found"),this.dep=e}gatherData(){return mr(this.dep)}replace(e){this.items.value.has(e.id)?(this.items.value.delete(e.id),this.insertNew(e)):console.warn(e+"Does not exist in the map")}}(0,C.Z)(vr,"G_CURRENT_DEPARTMENT","department");const pr=(0,Vi.Q_)("contraint",(()=>{const e=new vr,t=e.items;function a(t){e.insertNew(t)}function n(t){e.replace(t)}function i(){return e.initialize()}return{items:t,insertNew:a,initialize:i,replace:n}})),hr=e=>((0,f.dD)("data-v-7fea7b82"),e=e(),(0,f.Cn)(),e),yr=hr((()=>(0,f._)("hr",null,null,-1)));var br=(0,f.aZ)({__name:"DisplayDocInPopoverAdapter",props:{showDoc:{type:Boolean}},emits:["updateShowDoc"],setup(e,{emit:t}){const a=e,n="80vw",i="contextmenu",o=document.getElementById("constraints-body"),s=o,r=new RegExp("^\\D+\\d+$"),l="currentPopover",u="popover",c="btn-group",d=pr(),m=(0,f.iH)(!1),v=(0,f.iH)(null),p=(0,f.iH)(0);function h(){const e=document.getElementsByClassName(u).item(0);null!==e&&(e.style.maxWidth=n,window.scroll(e.getBoundingClientRect().right,0));const t=document.getElementsByClassName(c);for(let a=0;a<t.length;a++){const e=t.item(a);null!=e&&(e.style.alignItems="center",e.style.justifyContent="center",e.style.display="flex")}}function y(){p.value<2?p.value++:p.value=0,h()}function b(){t("updateShowDoc",a.showDoc)}function _(){const e=window.eval(l);if(e){m.value=!0;const t=e._element.getAttribute("data-cst-id"),a=t.match(r);if(a&&d.items.has(a[0]))return d.items.get(a[0]);console.warn(`constraint ${a} not found in the store`)}else console.warn(`${l} element not found`)}function w(){const e=_();v.value=e||null}return d.initialize().then((()=>{w()})),s.addEventListener(i,(e=>{w(),v.value&&y()}),!1),new MutationObserver((e=>e.forEach((()=>{0==o.getElementsByClassName("popover").length&&(v.value=null)})))).observe(o,{childList:!0}),h(),(t,a)=>m.value?((0,f.wg)(),(0,f.iD)(f.HY,{key:0},[v.value?((0,f.wg)(),(0,f.j4)(f.lR,{to:".popover-body",key:p.value},[yr,(0,f.Wm)(or,{constraint:v.value,showDoc:e.showDoc,onUpdateShowDoc:b,hideLabel:"",showLabel:""},null,8,["constraint","showDoc"])])):(0,f.kq)("",!0)],64)):(0,f.kq)("",!0)}});const fr=(0,en.Z)(br,[["__scopeId","data-v-7fea7b82"]]);var _r=fr;const wr={class:"documentationContainer"};var gr;(function(e){e[e["Nothing"]=0]="Nothing",e[e["CreateNewConstraint"]=1]="CreateNewConstraint",e[e["EditConstraint"]=2]="EditConstraint"})(gr||(gr={}));var kr=(0,f.aZ)({__name:"DisplayDocInNewConstraintAdapter",props:{showDoc:{type:Boolean}},emits:["updateShowDoc"],async setup(e,{emit:t}){let a,n;const i=e,o="modal-dialog modal-dialog-centered modal-dialog-scrollable",s=`${o} modal-xl`,r="500px";let l=gr.Nothing;const u=(0,f.iH)(null);let c=new Map;const d=document.getElementById("constraint-edit-type"),m=document.getElementById("constraint-edit-popup"),v=pr();function p(){t("updateShowDoc",i.showDoc)}function h(e){const t=document.getElementsByClassName("modal-dialog").item(0);t.className=e?s:o}function y(){const e=document.getElementsByClassName("modal-content").item(0);e.style.flexDirection="row";const t=document.getElementsByClassName("modal-header").item(0),a=document.getElementsByClassName("modal-body").item(0),n=document.getElementsByClassName("modal-footer").item(0),i=document.createElement("div");i.style.maxWidth=r,i.style.overflowX="auto",i.style.flexDirection="column",i.style.display="flex",i.appendChild(t),i.appendChild(a),i.appendChild(n),e.appendChild(i)}function b(){const e=Array.from(c.values()).find((e=>d.value==e.local_name));if(e){const t=new Map;e.parameters.forEach((e=>t.set(e.name,null))),u.value=new rr(0,"",e.className,0,!0,"","",t)}else u.value=null}function _(){let e,t;switch(l){case gr.CreateNewConstraint:e=window.eval("newConstraint"),t=rr.unserialize(window.eval(`constraints["${e.name+e.id}"]`)),v.insertNew(t);break;case gr.EditConstraint:e=window.eval("editConstraint"),t=rr.unserialize(window.eval(`constraints["${e.name+e.id}"]`)),v.replace(t);break;default:console.error("The modal is in an unsupported state")}}return d?.addEventListener("change",(()=>{b()})),[a,n]=(0,f.mv)((()=>cr().then((function(e){c=e})))),await a,n(),y(),(0,f.YP)((()=>i.showDoc),(()=>{h(i.showDoc)})),v.initialize(),new MutationObserver(((e,t)=>e.forEach((e=>{if("attributes"===e.type&&"class"===e.attributeName)if(m.classList.contains("show"))switch(b(),window.eval("currentState")){case window.eval("State.CreateNewConstraint"):l=gr.CreateNewConstraint;break;case window.eval("State.EditConstraint"):l=gr.EditConstraint;break;default:console.error("The modal is in an unsupported state")}else u.value=null})))).observe(m,{attributes:!0}),document.getElementById("confirm-edit-constraint")?.addEventListener("click",(()=>_())),(t,a)=>((0,f.wg)(),(0,f.j4)(f.lR,{to:".modal-content"},[(0,f._)("div",wr,[(0,f.Wm)(or,{constraint:u.value,showDoc:e.showDoc,onUpdateShowDoc:p,hideLabel:"",showLabel:""},null,8,["constraint","showDoc"])])]))}});const Dr=(0,en.Z)(kr,[["__scopeId","data-v-f0bfbfa8"]]);var Cr=Dr,Sr=(0,f.aZ)({__name:"ConstraintManager",setup(e){const t=(0,f.iH)(!1);function a(){t.value=!t.value}return(e,n)=>((0,f.wg)(),(0,f.iD)(f.HY,null,[(0,f.Wm)(_r,{showDoc:t.value,onUpdateShowDoc:a},null,8,["showDoc"]),((0,f.wg)(),(0,f.j4)(f.n4,null,{default:(0,f.w5)((()=>[(0,f.Wm)(Cr,{showDoc:t.value,onUpdateShowDoc:a},null,8,["showDoc"])])),_:1}))],64))}});const xr=Sr;var Tr=xr;const Er=(0,f.ri)(No).use((0,Vi.WB)()),Mr=(0,f.ri)(Tr).use((0,Vi.WB)()),Hr=new Date,Ur=new Date(Hr.getFullYear(),0,1),Pr=Math.floor((Hr.getTime()-Ur.getTime())/864e5),Fr=Math.ceil(Pr/7),jr=(0,f.iH)({week:Fr,year:Hr.getFullYear()}),Or=window.location.pathname,Ir=new RegExp("(/(?<lang>.*?)/).*"),Rr=Or.match(Ir)?.groups?.lang,zr=[{nameOfImport:"PopperComponent",valueOfImport:k.Z}],$r=[{nameOfImport:"VueShowdown",valueOfImport:D.Kf}],Zr=[{appName:"roomreservation",app:Er,importedComponents:zr},{appName:"constraintmanager",app:Mr,importedComponents:$r}],Nr=(0,Vi.WB)();Zr.forEach((({appName:e,app:t,importedComponents:a})=>{t.provide(w,(0,f.OT)(y)),t.provide(_,(0,f.OT)(jr.value)),t.provide("lang",Rr),t.use(Nr),a.forEach((e=>{t.component(e.nameOfImport,e.valueOfImport)})),t.mount(`#${e}-app`)}))}},t={};function a(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,n,i,o){if(!n){var s=1/0;for(c=0;c<e.length;c++){n=e[c][0],i=e[c][1],o=e[c][2];for(var r=!0,l=0;l<n.length;l++)(!1&o||s>=o)&&Object.keys(a.O).every((function(e){return a.O[e](n[l])}))?n.splice(l--,1):(r=!1,o<s&&(s=o));if(r){e.splice(c--,1);var u=i();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,i,o]}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,o,s=n[0],r=n[1],l=n[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(i in r)a.o(r,i)&&(a.m[i]=r[i]);if(l)var c=l(a)}for(t&&t(n);u<s.length;u++)o=s[u],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(c)},n=self["webpackChunkflopedt_front"]=self["webpackChunkflopedt_front"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(3684)}));n=a.O(n)})();
//# sourceMappingURL=app.js.map